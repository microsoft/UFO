<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Execution - UFO Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Execution";
        var mkdocs_page_input_path = "dataflow/execution.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> UFO Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../project_directory_structure/">Project Directory Structure</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/more_guidance/">More Guidance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Basic Modules</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/session/">Session</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/round/">Round</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/context/">Context</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configurations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/user_configuration/">User Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/developer_configuration/">Developer Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/pricing_configuration/">Model Pricing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Supported Models</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/openai/">OpenAI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/azure_openai/">Azure OpenAI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/operator/">OpenAI CUA (Operator)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/gemini/">Gemini</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/claude/">Claude</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/qwen/">Qwen</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/deepseek/">DeepSeek</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/ollama/">Ollama</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/custom_model/">Custom Model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agents</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Agent Design</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/memory/">Memory</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/blackboard/">Blackboard</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/state/">State</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/prompter/">Prompter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/processor/">Processor</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/host_agent/">HostAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/app_agent/">AppAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/follower_agent/">FollowerAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/evaluation_agent/">EvaluationAgent</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Prompts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/basic_template/">Basic Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/examples_prompts/">Examples Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/api_prompts/">API Prompts</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Puppeteer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/ui_automator/">GUI Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/wincom_automator/">API Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/web_automator/">Web Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/bash_automator/">Bash Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/ai_tool_automator/">AI Tool</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Logs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/markdown_log_viewer/">Markdown Log Viewer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/request_logs/">Request Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/step_logs/">Step Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/evaluation_logs/">Evaluation Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/screenshots_logs/">Screenshots</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/ui_tree_logs/">UI Tree</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Continuous Knowledge Substrate</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_help_document/">Learning from Help Document</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_bing_search/">Learning from Bing Search</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/experience_learning/">Experience Learning</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_demonstration/">Learning from User Demonstration</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/follower_mode/">Follower Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/batch_mode/">Batch Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/multi_action/">Speculative Multi-Action Execution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/operator_as_app_agent/">Operator-as-a-AppAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Control Filtering</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/text_filtering/">Text Filtering</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/semantic_filtering/">Semantic Filtering</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/icon_filtering/">Icon Filtering</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Control Detection</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/uia_detection/">UIA Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/visual_detection/">Visual Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/hybrid_detection/">Hybrid Detection</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/customization/">Customization</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Creating Your AppAgent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/help_document_provision/">Help Document Provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/demonstration_provision/">Demonstration Provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/warpping_app_native_api/">Warpping App-Native API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Benchmark</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/windows_agent_arena/">Windows Agent Arena</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/osworld/">OSWorld (Windows)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Dataflow</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../instantiation/">Instantiation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Execution</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#executeflow">ExecuteFlow</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#task-execution">Task Execution</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#evaluation">Evaluation</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../windows_app_env/">Windows App Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../result/">Result</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/LICENSE/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/CODE_OF_CONDUCT/">Code of Conduct</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/DISCLAIMER/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/SUPPORT/">Support</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">UFO Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Dataflow</li>
      <li class="breadcrumb-item active">Execution</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="execution">Execution</h1>
<p>The instantiated plans will be executed by a <code>execute</code> task. In this phase, given the task-action data, the execution process will match the real controller based on word environment and execute the plan step by step. After execution, <code>evalution</code> agent will evaluation the quality of the entire execution process.</p>
<h1 align="center">
    <img src="../../img/execution.png"/> 
</h1>

<h2 id="executeflow">ExecuteFlow</h2>
<p>The <code>ExecuteFlow</code> class is designed to facilitate the execution and evaluation of tasks in a Windows application environment. It provides functionality to interact with the application's UI, execute predefined tasks, capture screenshots, and evaluate the results of the execution. The class also handles logging and error management for the tasks.</p>
<h3 id="task-execution">Task Execution</h3>
<p>The <strong>task execution</strong> in the <code>ExecuteFlow</code> class follows a structured sequence to ensure accurate and traceable task performance:</p>
<ol>
<li>
<p><strong>Initialization</strong>:</p>
</li>
<li>
<p>Load configuration settings and log paths.</p>
</li>
<li>Find the application window matching the task.</li>
<li>Retrieve or create an <code>ExecuteAgent</code> for executing the task.</li>
<li>
<p><strong>Plan Execution</strong>:</p>
</li>
<li>
<p>Loop through each step in the <code>instantiated_plan</code>.</p>
</li>
<li>Parse the step to extract information like subtasks, control text, and the required operation.</li>
<li>
<p><strong>Action Execution</strong>:</p>
</li>
<li>
<p>Find the control in the application window that matches the specified control text.</p>
</li>
<li>If no matching control is found, raise an error.</li>
<li>Perform the specified action (e.g., click, input text) using the agent's Puppeteer framework.</li>
<li>Capture screenshots of the application window and selected controls for logging and debugging.</li>
<li>
<p><strong>Result Logging</strong>:</p>
</li>
<li>
<p>Log details of the step execution, including control information, performed action, and results.</p>
</li>
<li>
<p><strong>Finalization</strong>:</p>
</li>
<li>
<p>Save the final state of the application window.</p>
</li>
<li>Quit the application client gracefully.</li>
</ol>
<hr />
<h2 id="evaluation">Evaluation</h2>
<p>The <strong>evaluation</strong> process in the <code>ExecuteFlow</code> class is designed to assess the performance of the executed task based on predefined prompts:</p>
<ol>
<li>
<p><strong>Start Evaluation</strong>:</p>
</li>
<li>
<p>Evaluation begins immediately after task execution.</p>
</li>
<li>It uses an <code>ExecuteEvalAgent</code> initialized during class construction.</li>
<li>
<p><strong>Perform Evaluation</strong>:</p>
</li>
<li>
<p>The <code>ExecuteEvalAgent</code> evaluates the task using a combination of input prompts (e.g., main prompt and API prompt) and logs generated during task execution.</p>
</li>
<li>The evaluation process outputs a result summary (e.g., quality flag, comments, and task type).</li>
<li>
<p><strong>Log and Output Results</strong>:</p>
</li>
<li>
<p>Display the evaluation results in the console.</p>
</li>
<li>Return the evaluation summary alongside the executed plan for further analysis or reporting.</li>
</ol>
<h1 id="reference">Reference</h1>
<h2 id="executeflow_1">ExecuteFlow</h2>


<div class="doc doc-object doc-class">



<a id="execution.workflow.execute_flow.ExecuteFlow"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ufo.agents.processors.app_agent_processor.AppAgentProcessor">AppAgentProcessor</span></code></p>


        <p>ExecuteFlow class for executing the task and saving the result.</p>

        <p>Initialize the execute flow for a task.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>task_file_name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Name of the task file being processed.</p>
              </div>
            </li>
            <li>
              <b><code>context</code></b>
                  (<code><span title="ufo.module.basic.Context">Context</span></code>)
              –
              <div class="doc-md-description">
                <p>Context object for the current session.</p>
              </div>
            </li>
            <li>
              <b><code>environment</code></b>
                  (<code><span title="dataflow.env.env_manager.WindowsAppEnv">WindowsAppEnv</span></code>)
              –
              <div class="doc-md-description">
                <p>Environment object for the application being processed.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>






                  <details class="quote">
                    <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">task_file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="n">WindowsAppEnv</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the execute flow for a task.</span>
<span class="sd">    :param task_file_name: Name of the task file being processed.</span>
<span class="sd">    :param context: Context object for the current session.</span>
<span class="sd">    :param environment: Environment object for the application being processed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">agent</span><span class="o">=</span><span class="n">ExecuteAgent</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eval_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span> <span class="o">=</span> <span class="n">environment</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_task_file_name</span> <span class="o">=</span> <span class="n">task_file_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span><span class="o">.</span><span class="n">app_name</span>

    <span class="n">log_path</span> <span class="o">=</span> <span class="n">_configs</span><span class="p">[</span><span class="s2">&quot;EXECUTE_LOG_PATH&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="n">task_file_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_logs</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span><span class="o">.</span><span class="n">find_matching_window</span><span class="p">(</span><span class="n">task_file_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_or_create_execute_agent</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eval_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_or_create_evaluation_agent</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_matched_control</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Matched control for the current step.</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.execute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">instantiated_plan</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Execute the execute flow: Execute the task and save the result.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>request</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Original request to be executed.</p>
              </div>
            </li>
            <li>
              <b><code>instantiated_plan</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>)
              –
              <div class="doc-md-description">
                <p>Instantiated plan containing steps to execute.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]], <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
              –
              <div class="doc-md-description">
                <p>Tuple containing task quality flag, comment, and task type.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">instantiated_plan</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the execute flow: Execute the task and save the result.</span>
<span class="sd">    :param request: Original request to be executed.</span>
<span class="sd">    :param instantiated_plan: Instantiated plan containing steps to execute.</span>
<span class="sd">    :return: Tuple containing task quality flag, comment, and task type.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">executed_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_plan</span><span class="p">(</span><span class="n">instantiated_plan</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Execution failed. </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_agent</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
            <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span>
        <span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluation failed. </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eval_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">executed_plan</span><span class="p">,</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.execute_action" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_action</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Execute the action.</p>


            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the action.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">control_selected</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Find the matching window and control.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span><span class="o">.</span><span class="n">find_matching_window</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_task_file_name</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_text</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">control_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_control_label</span><span class="p">,</span> <span class="n">control_selected</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span><span class="o">.</span><span class="n">find_matching_controller</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_annotation_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_text</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">control_selected</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matched_control</span> <span class="o">=</span> <span class="n">control_selected</span><span class="o">.</span><span class="n">window_text</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">control_selected</span><span class="p">:</span>
        <span class="c1"># If the control is not found, raise an error.</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control with text &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">control_text</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the selected control item from the annotation dictionary and LLM response.</span>
        <span class="c1"># The LLM response is a number index corresponding to the key in the annotation dictionary.</span>
        <span class="k">if</span> <span class="n">control_selected</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">_ufo_configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SHOW_VISUAL_OUTLINE_ON_SCREEN&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">control_selected</span><span class="o">.</span><span class="n">draw_outline</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">_ufo_configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;RECTANGLE_TIME&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

            <span class="n">control_coordinates</span> <span class="o">=</span> <span class="n">PhotographerDecorator</span><span class="o">.</span><span class="n">coordinate_adjusted</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(),</span> <span class="n">control_selected</span><span class="o">.</span><span class="n">rectangle</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_control_log</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;control_class&quot;</span><span class="p">:</span> <span class="n">control_selected</span><span class="o">.</span><span class="n">element_info</span><span class="o">.</span><span class="n">class_name</span><span class="p">,</span>
                <span class="s2">&quot;control_type&quot;</span><span class="p">:</span> <span class="n">control_selected</span><span class="o">.</span><span class="n">element_info</span><span class="o">.</span><span class="n">control_type</span><span class="p">,</span>
                <span class="s2">&quot;control_automation_id&quot;</span><span class="p">:</span> <span class="n">control_selected</span><span class="o">.</span><span class="n">element_info</span><span class="o">.</span><span class="n">automation_id</span><span class="p">,</span>
                <span class="s2">&quot;control_friendly_class_name&quot;</span><span class="p">:</span> <span class="n">control_selected</span><span class="o">.</span><span class="n">friendly_class_name</span><span class="p">(),</span>
                <span class="s2">&quot;control_coordinates&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="n">control_coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="n">control_coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="n">control_coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="n">control_coordinates</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">},</span>
            <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">Puppeteer</span><span class="o">.</span><span class="n">receiver_manager</span><span class="o">.</span><span class="n">create_ui_control_receiver</span><span class="p">(</span>
                <span class="n">control_selected</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span>
            <span class="p">)</span>

            <span class="c1"># Save the screenshot of the tagged selected control.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">capture_control_screenshot</span><span class="p">(</span><span class="n">control_selected</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">Puppeteer</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_operation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control_reannotate</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_json_serializable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

                <span class="k">return</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_error_handler</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.execute_plan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_plan</span><span class="p">(</span><span class="n">instantiated_plan</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the executed result from the execute agent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>instantiated_plan</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>)
              –
              <div class="doc-md-description">
                <p>Plan containing steps to execute.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
              –
              <div class="doc-md-description">
                <p>List of executed steps.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_plan</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">instantiated_plan</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the executed result from the execute agent.</span>
<span class="sd">    :param instantiated_plan: Plan containing steps to execute.</span>
<span class="sd">    :return: List of executed steps.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize the step counter and capture the initial screenshot.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">session_step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Initialize the API receiver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">Puppeteer</span><span class="o">.</span><span class="n">receiver_manager</span><span class="o">.</span><span class="n">create_api_receiver</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">_app_root_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">_process_name</span>
        <span class="p">)</span>
        <span class="c1"># Initialize the control receiver</span>
        <span class="n">current_receiver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">Puppeteer</span><span class="o">.</span><span class="n">receiver_manager</span><span class="o">.</span><span class="n">receiver_list</span><span class="p">[</span>
            <span class="o">-</span><span class="mi">1</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">current_receiver</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span><span class="o">.</span><span class="n">find_matching_window</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_task_file_name</span>
            <span class="p">)</span>
            <span class="n">current_receiver</span><span class="o">.</span><span class="n">com_object</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">current_receiver</span><span class="o">.</span><span class="n">get_object_from_process_name</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_and_final_capture_screenshot</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Execution initialization failed. </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize the success flag for each step.</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">step_plan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instantiated_plan</span><span class="p">):</span>
        <span class="n">instantiated_plan</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;Success&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">instantiated_plan</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;MatchedControlText&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">step_plan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instantiated_plan</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session_step</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Check if the maximum steps have been exceeded.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_step</span> <span class="o">&gt;</span> <span class="n">_configs</span><span class="p">[</span><span class="s2">&quot;MAX_STEPS&quot;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Maximum steps exceeded.&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_step_plan</span><span class="p">(</span><span class="n">step_plan</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
                <span class="n">instantiated_plan</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;Success&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">instantiated_plan</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;ControlLabel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control_label</span>
                <span class="n">instantiated_plan</span><span class="p">[</span><span class="n">index</span><span class="p">][</span>
                    <span class="s2">&quot;MatchedControlText&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matched_control</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ControllerNotFoundError</span><span class="p">:</span>
                <span class="n">instantiated_plan</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;Success&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">raise</span> <span class="n">ControllerNotFoundError</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">err_info</span> <span class="o">=</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Step </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">session_step</span><span class="si">}</span><span class="s2"> execution failed. </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">err_info</span>
    <span class="c1"># capture the final screenshot</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">session_step</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_and_final_capture_screenshot</span><span class="p">()</span>
    <span class="c1"># save the final state of the app</span>

    <span class="n">win_com_receiver</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">receiver</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">Puppeteer</span><span class="o">.</span><span class="n">receiver_manager</span><span class="o">.</span><span class="n">receiver_list</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">WinCOMReceiverBasic</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">receiver</span><span class="o">.</span><span class="n">client</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">win_com_receiver</span> <span class="o">=</span> <span class="n">receiver</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">win_com_receiver</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">win_com_receiver</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">win_com_receiver</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Quit</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Execution complete.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">instantiated_plan</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.general_error_handler" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">general_error_handler</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handle general errors.</p>


            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">general_error_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle general errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.init_and_final_capture_screenshot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init_and_final_capture_screenshot</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Capture the screenshot.</p>


            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_and_final_capture_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Capture the screenshot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Define the paths for the screenshots saved.</span>
    <span class="n">screenshot_save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_path</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;action_step</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">session_step</span><span class="si">}</span><span class="s2">.png&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_memory_data</span><span class="o">.</span><span class="n">add_values_from_dict</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;CleanScreenshot&quot;</span><span class="p">:</span> <span class="n">screenshot_save_path</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">photographer</span><span class="o">.</span><span class="n">capture_app_window_screenshot</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="n">screenshot_save_path</span>
    <span class="p">)</span>
    <span class="c1"># Capture the control screenshot.</span>
    <span class="n">control_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_env</span><span class="o">.</span><span class="n">app_window</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capture_control_screenshot</span><span class="p">(</span><span class="n">control_selected</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.log_save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_save</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Log the constructed prompt message for the PrefillAgent.</p>


            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">log_save</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Log the constructed prompt message for the PrefillAgent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">step_memory</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Step&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_step</span><span class="p">,</span>
        <span class="s2">&quot;Subtask&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtask</span><span class="p">,</span>
        <span class="s2">&quot;ControlLabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control_label</span><span class="p">,</span>
        <span class="s2">&quot;ControlText&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_text</span><span class="p">,</span>
        <span class="s2">&quot;Action&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">,</span>
        <span class="s2">&quot;ActionType&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">Puppeteer</span><span class="o">.</span><span class="n">get_command_types</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operation</span><span class="p">),</span>
        <span class="s2">&quot;Results&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span>
        <span class="s2">&quot;Application&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">_app_root_name</span><span class="p">,</span>
        <span class="s2">&quot;TimeCost&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cost</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_memory_data</span><span class="o">.</span><span class="n">add_values_from_dict</span><span class="p">(</span><span class="n">step_memory</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.print_step_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_step_info</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Print the step information.</p>


            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_step_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print the step information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">utils</span><span class="o">.</span><span class="n">print_with_color</span><span class="p">(</span>
        <span class="s2">&quot;Step </span><span class="si">{step}</span><span class="s2">: </span><span class="si">{subtask}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">session_step</span><span class="p">,</span>
            <span class="n">subtask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subtask</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s2">&quot;magenta&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="execution.workflow.execute_flow.ExecuteFlow.process" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process the current step.</p>


            <details class="quote">
              <summary>Source code in <code>execution/workflow/execute_flow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process the current step.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">step_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">print_step_info</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capture_screenshot</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execute_action</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_cost</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">step_start_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_save</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="executeagent">ExecuteAgent</h2>


<div class="doc doc-object doc-class">



<a id="execution.agent.execute_agent.ExecuteAgent"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ufo.agents.agent.app_agent.AppAgent">AppAgent</span></code></p>


        <p>The Agent for task execution.</p>

        <p>Initialize the ExecuteAgent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of the agent.</p>
              </div>
            </li>
            <li>
              <b><code>process_name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of the process.</p>
              </div>
            </li>
            <li>
              <b><code>app_root_name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of the app root.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>






                  <details class="quote">
                    <summary>Source code in <code>execution/agent/execute_agent.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">process_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_root_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ExecuteAgent.</span>
<span class="sd">    :param name: The name of the agent.</span>
<span class="sd">    :param process_name: The name of the process.</span>
<span class="sd">    :param app_root_name: The name of the app root.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_complete</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_process_name</span> <span class="o">=</span> <span class="n">process_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_app_root_name</span> <span class="o">=</span> <span class="n">app_root_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Puppeteer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_puppeteer_interface</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="executeevalagent">ExecuteEvalAgent</h2>


<div class="doc doc-object doc-class">



<a id="execution.agent.execute_eval_agent.ExecuteEvalAgent"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ufo.agents.agent.evaluation_agent.EvaluationAgent">EvaluationAgent</span></code></p>


        <p>The Agent for task execution evaluation.</p>

        <p>Initialize the ExecuteEvalAgent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of the agent.</p>
              </div>
            </li>
            <li>
              <b><code>app_root_name</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of the app root.</p>
              </div>
            </li>
            <li>
              <b><code>is_visual</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>The flag indicating whether the agent is visual or not.</p>
              </div>
            </li>
            <li>
              <b><code>main_prompt</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The main prompt.</p>
              </div>
            </li>
            <li>
              <b><code>example_prompt</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The example prompt.</p>
              </div>
            </li>
            <li>
              <b><code>api_prompt</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The API prompt.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>






                  <details class="quote">
                    <summary>Source code in <code>execution/agent/execute_eval_agent.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_root_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">is_visual</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">main_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">example_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ExecuteEvalAgent.</span>
<span class="sd">    :param name: The name of the agent.</span>
<span class="sd">    :param app_root_name: The name of the app root.</span>
<span class="sd">    :param is_visual: The flag indicating whether the agent is visual or not.</span>
<span class="sd">    :param main_prompt: The main prompt.</span>
<span class="sd">    :param example_prompt: The example prompt.</span>
<span class="sd">    :param api_prompt: The API prompt.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">app_root_name</span><span class="o">=</span><span class="n">app_root_name</span><span class="p">,</span>
        <span class="n">is_visual</span><span class="o">=</span><span class="n">is_visual</span><span class="p">,</span>
        <span class="n">main_prompt</span><span class="o">=</span><span class="n">main_prompt</span><span class="p">,</span>
        <span class="n">example_prompt</span><span class="o">=</span><span class="n">example_prompt</span><span class="p">,</span>
        <span class="n">api_prompt</span><span class="o">=</span><span class="n">api_prompt</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="execution.agent.execute_eval_agent.ExecuteEvalAgent.get_prompter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_prompter</span><span class="p">(</span><span class="n">is_visual</span><span class="p">,</span> <span class="n">prompt_template</span><span class="p">,</span> <span class="n">example_prompt_template</span><span class="p">,</span> <span class="n">api_prompt_template</span><span class="p">,</span> <span class="n">root_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the prompter for the agent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>is_visual</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>The flag indicating whether the agent is visual or not.</p>
              </div>
            </li>
            <li>
              <b><code>prompt_template</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The prompt template.</p>
              </div>
            </li>
            <li>
              <b><code>example_prompt_template</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The example prompt template.</p>
              </div>
            </li>
            <li>
              <b><code>api_prompt_template</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The API prompt template.</p>
              </div>
            </li>
            <li>
              <b><code>root_name</code></b>
                  (<code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The name of the root.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="dataflow.prompter.execution.execute_eval_prompter.ExecuteEvalAgentPrompter">ExecuteEvalAgentPrompter</span></code>
              –
              <div class="doc-md-description">
                <p>The prompter.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>execution/agent/execute_eval_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_prompter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_visual</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">example_prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">root_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExecuteEvalAgentPrompter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the prompter for the agent.</span>
<span class="sd">    :param is_visual: The flag indicating whether the agent is visual or not.</span>
<span class="sd">    :param prompt_template: The prompt template.</span>
<span class="sd">    :param example_prompt_template: The example prompt template.</span>
<span class="sd">    :param api_prompt_template: The API prompt template.</span>
<span class="sd">    :param root_name: The name of the root.</span>
<span class="sd">    :return: The prompter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">ExecuteEvalAgentPrompter</span><span class="p">(</span>
        <span class="n">is_visual</span><span class="o">=</span><span class="n">is_visual</span><span class="p">,</span>
        <span class="n">prompt_template</span><span class="o">=</span><span class="n">prompt_template</span><span class="p">,</span>
        <span class="n">example_prompt_template</span><span class="o">=</span><span class="n">example_prompt_template</span><span class="p">,</span>
        <span class="n">api_prompt_template</span><span class="o">=</span><span class="n">api_prompt_template</span><span class="p">,</span>
        <span class="n">root_name</span><span class="o">=</span><span class="n">root_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../instantiation/" class="btn btn-neutral float-left" title="Instantiation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../windows_app_env/" class="btn btn-neutral float-right" title="Windows App Environment">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../instantiation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../windows_app_env/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
