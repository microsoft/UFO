<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Wrapping App-Native APIs - UFO³ Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Wrapping App-Native APIs";
        var mkdocs_page_input_path = "tutorials/creating_app_agent/warpping_app_native_api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> UFO³ Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../choose_path/">Choose Your Path</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../project_directory_structure/">Project Directory Structure</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_galaxy/">Quick Start (UFO³ Agent Galaxy)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_ufo2/">Quick Start (UFO²)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_linux/">Quick Start (Linux Agent)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_mobile/">Quick Start (Mobile Agent)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/migration_ufo2_to_galaxy/">Migration UFO² → UFO³</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/more_guidance/">More Guidance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration & Setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Configuration System</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/agents_config/">Agent Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/system_config/">System Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/rag_config/">RAG Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/prices_config/">Pricing Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/third_party_config/">Third-Party Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/mcp_reference/">MCP Reference</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/migration/">Migration Guide</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/extending/">Extending Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Galaxy Configuration</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_devices/">Devices</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_constellation/">Constellation</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_agent/">Agent</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Model Setup</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/openai/">OpenAI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/azure_openai/">Azure OpenAI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/operator/">OpenAI CUA (Operator)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/gemini/">Gemini</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/claude/">Claude</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/qwen/">Qwen</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/deepseek/">DeepSeek</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/ollama/">Ollama</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/custom_model/">Custom Model</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UFO³ Agent Galaxy</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../galaxy/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../galaxy/webui/">WebUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Galaxy Client</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/constellation_client/">ConstellationClient</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/device_manager/">DeviceManager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/components/">Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/aip_integration/">AIP Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/galaxy_client/">GalaxyClient</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Agent Registration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/agent_profile/">Agent Profile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/device_registry/">Device Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/registration_flow/">Registration Flow</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Task Constellation (DAG)</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_star/">TaskStar</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_star_line/">TaskStarLine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_constellation/">TaskConstellation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/constellation_editor/">ConstellationEditor</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Constellation Agent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/strategy/">Strategy Pattern</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/command/">MCP Commands</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Constellation Orchestrator</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/event_driven_coordination/">Event-Driven Coordination</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/asynchronous_scheduling/">Asynchronous Scheduling</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/safe_assignment_locking/">Safe Assignment Locking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/consistency_guarantees/">Consistency Guarantees</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/batched_editing/">Batched Editing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/constellation_manager/">Constellation Manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/api_reference/">API Reference</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Observer System</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/event_system/">Event System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/progress_observer/">Progress Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/agent_output_observer/">Agent Output Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/synchronizer/">Synchronizer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/metrics_observer/">Metrics Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/visualization_observer/">Visualization Observer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation & Logging</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/trajectory_report/">Trajectory Report</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/performance_metrics/">Performance Metrics</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/result_json/">Result JSON Reference</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UFO² Desktop AgentOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ufo2/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ufo2/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >HostAgent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/strategy/">Processing Strategy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/commands/">Command System</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >AppAgent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/strategy/">Processing Strategy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/commands/">Command System</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core Features</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/core_features/hybrid_actions/">Hybrid GUI–API Actions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Control Detection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/uia_detection/">UIA Detection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/visual_detection/">Visual Detection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/hybrid_detection/">Hybrid Detection</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Knowledge Substrate</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/learning_from_help_document/">Help Documents</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/learning_from_bing_search/">Bing Search</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/experience_learning/">Experience Learning</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/learning_from_demonstration/">Demos</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/core_features/multi_action/">Speculative Multi-Action</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Advanced Usage</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/follower_mode/">Follower Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/batch_mode/">Batch Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/operator_as_app_agent/">Operator Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/customization/">Customization</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Prompts</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/prompts/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/prompts/basic_template/">Basic Template</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/prompts/examples_prompts/">Examples</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/evaluation_agent/">EvaluationAgent</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/benchmark/overview/">Benchmark Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/benchmark/windows_agent_arena/">Windows Agent Arena</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/benchmark/osworld/">OSWorld (Windows)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Performance Logs</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/evaluation_logs/">Evaluation Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/markdown_log_viewer/">Markdown Log Viewer</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/request_logs/">Request Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/screenshots_logs/">Screenshots Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/step_logs/">Step Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/ui_tree_logs/">UI Tree Logs</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Dataflow</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/instantiation/">Instantiation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/execution/">Execution</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/windows_app_env/">Windows App Environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/result/">Result</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Linux Agent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/state/">State Machine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/strategy/">Processing Strategy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/commands/">MCP Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mobile Agent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/state/">State Machine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/strategy/">Processing Strategy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/commands/">MCP Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials & Development</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_mcp_servers/">Creating Custom MCP Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_third_party_agents/">Creating Custom Third-Party Agents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Creating Custom Device Agents</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/client_setup/">Client Setup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/core_components/">Core Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/mcp_server/">MCP Server</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/configuration/">Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/testing/">Testing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../creating_device_agent/example_mobile_agent/">Example Mobile Agent</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Enhancing AppAgent Capabilities</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../help_document_provision/">Help Document Provision</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../demonstration_provision/">Demonstration Provision</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Wrapping App-Native APIs</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-by-step-guide">Step-by-Step Guide</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#step-1-create-your-mcp-server-file">Step 1: Create Your MCP Server File</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-2-define-tool-methods-with-mcptool">Step 2: Define Tool Methods with @mcp.tool()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-3-implement-the-underlying-api-receiver">Step 3: Implement the Underlying API Receiver</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-4-create-command-classes">Step 4: Create Command Classes</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-5-register-your-receiver-in-the-factory">Step 5: Register Your Receiver in the Factory</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-6-register-the-mcp-server-in-mcpyaml">Step 6: Register the MCP Server in mcp.yaml</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#step-7-test-your-mcp-server">Step 7: Test Your MCP Server</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#complete-example-excel-com-executor">Complete Example: Excel COM Executor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#legacy-approach-api-prompt-files-deprecated">Legacy Approach: API Prompt Files (Deprecated)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#best-practices">Best Practices</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-comprehensive-docstrings">1. Comprehensive Docstrings</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-error-handling">2. Error Handling</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-parameter-validation">3. Parameter Validation</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#4-fallback-to-ui-automation">4. Fallback to UI Automation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#issue-com-object-not-found">Issue: COM Object Not Found</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#issue-permission-denied">Issue: Permission Denied</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#issue-tools-not-appearing-in-llm-prompt">Issue: Tools Not Appearing in LLM Prompt</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#related-documentation">Related Documentation</a>
    </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Infrastructure</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Basic Modules</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/session/">Session</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/round/">Round</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/context/">Context</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/dispatcher/">Dispatcher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/session_pool/">Session Factory & Pool</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/platform_sessions/">Platform Sessions</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Device Agent Architecture</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/agents/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/agents/agent_types/">Agent Types & Implementation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/agents/server_client_architecture/">Server-Client Architecture</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Architecture Layers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/state/">State Layer (Level-1)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/processor/">Strategy Layer (Level-2)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/strategy/">Strategy Components</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/command/">Command Layer (Level-3)</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Supporting Systems</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/memory/">Memory System</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/blackboard/">Blackboard</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/prompter/">Prompter</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Interaction Protocol (AIP)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/messages/">Message Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/protocols/">Protocol Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/transport/">Transport Layer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/endpoints/">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/resilience/">Resilience</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Server</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/session_manager/">Session Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/websocket_handler/">WebSocket Handler</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/client_connection_manager/">Client Connection Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/api/">HTTP API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/monitoring/">Monitoring</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Client</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/websocket_client/">WebSocket Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/ufo_client/">UFO Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/computer_manager/">Computer Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/computer/">Computer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/device_info/">Device Info Provider</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/mcp_integration/">MCP Integration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MCP (Model Context Protocol)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/data_collection/">Data Collection Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/action/">Action Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/configuration/">Configuration Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/local_servers/">Local Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/remote_servers/">Remote Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Server Reference</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/ui_collector/">UICollector</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/host_ui_executor/">HostUIExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/app_ui_executor/">AppUIExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/command_line_executor/">CommandLineExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/word_com_executor/">WordCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/excel_com_executor/">ExcelCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/ppt_com_executor/">PowerPointCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/pdf_reader_executor/">PDFReaderExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/constellation_editor/">ConstellationEditor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/hardware_executor/">HardwareExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/bash_executor/">BashExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/mobile_executor/">MobileExecutor</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/LICENSE/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CODE_OF_CONDUCT/">Code of Conduct</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/DISCLAIMER/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/SUPPORT/">Support</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../faq/">FAQ</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">UFO³ Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Tutorials & Development</li>
          <li class="breadcrumb-item">Enhancing AppAgent Capabilities</li>
      <li class="breadcrumb-item active">Wrapping App-Native APIs</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="wrapping-application-native-apis-as-mcp-action-servers">Wrapping Application Native APIs as MCP Action Servers</h1>
<p>UFO² uses <strong>MCP (Model Context Protocol) servers</strong> to expose application native APIs to the AppAgent. This document shows you how to create custom MCP action servers that wrap your application's COM APIs, REST APIs, or other programmable interfaces.</p>
<h2 id="overview">Overview</h2>
<p>While AppAgent can automate applications through UI controls, providing <strong>native API tools</strong> via MCP servers offers significant advantages:</p>
<table>
<thead>
<tr>
<th>Automation Method</th>
<th>Speed</th>
<th>Reliability</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>UI Automation</strong></td>
<td>Slower</td>
<td>Prone to UI changes</td>
<td>Visual elements, dialogs, menus</td>
</tr>
<tr>
<td><strong>Native API</strong></td>
<td>~10x faster</td>
<td>Deterministic</td>
<td>Data manipulation, batch operations</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Hybrid Automation</p>
<p>AppAgent combines both approaches - the LLM intelligently selects <strong>GUI tools</strong> (from UIExecutor) or <strong>API tools</strong> (from your custom MCP server) based on the task requirements.</p>
</div>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before creating a native API MCP server:</p>
<ol>
<li><strong>Understand MCP Servers</strong>: Read <a href="../../creating_mcp_servers/">Creating MCP Servers Tutorial</a></li>
<li><strong>Know Your API</strong>: Familiarize yourself with your application's COM API, REST API, or SDK</li>
<li><strong>Review Examples</strong>: Study existing servers in <code>ufo/client/mcp/local_servers/</code></li>
</ol>
<h2 id="step-by-step-guide">Step-by-Step Guide</h2>
<h3 id="step-1-create-your-mcp-server-file">Step 1: Create Your MCP Server File</h3>
<p>Create a new Python file in <code>ufo/client/mcp/local_servers/</code> for your application's MCP server:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># File: ufo/client/mcp/local_servers/your_app_executor.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Annotated</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.client.mcp.mcp_registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">MCPRegistry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.automator.puppeteer</span><span class="w"> </span><span class="kn">import</span> <span class="n">AppPuppeteer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.automator.action_execution</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActionExecutor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.agents.processors.schemas.actions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActionCommandInfo</span>


<span class="nd">@MCPRegistry</span><span class="o">.</span><span class="n">register_factory_decorator</span><span class="p">(</span><span class="s2">&quot;YourAppExecutor&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_your_app_executor</span><span class="p">(</span><span class="n">process_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FastMCP</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create MCP server for YourApp COM API automation.</span>

<span class="sd">    :param process_name: Process name for UI automation context.</span>
<span class="sd">    :return: FastMCP instance with YourApp tools.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize puppeteer for UI context</span>
    <span class="n">puppeteer</span> <span class="o">=</span> <span class="n">AppPuppeteer</span><span class="p">(</span>
        <span class="n">process_name</span><span class="o">=</span><span class="n">process_name</span><span class="p">,</span>
        <span class="n">app_root_name</span><span class="o">=</span><span class="s2">&quot;YOURAPP.EXE&quot;</span><span class="p">,</span>  <span class="c1"># Your app&#39;s executable name</span>
    <span class="p">)</span>

    <span class="c1"># Create COM API receiver</span>
    <span class="n">puppeteer</span><span class="o">.</span><span class="n">receiver_manager</span><span class="o">.</span><span class="n">create_api_receiver</span><span class="p">(</span>
        <span class="n">app_root_name</span><span class="o">=</span><span class="s2">&quot;YOURAPP.EXE&quot;</span><span class="p">,</span>
        <span class="n">process_name</span><span class="o">=</span><span class="n">process_name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">executor</span> <span class="o">=</span> <span class="n">ActionExecutor</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_execute_action</span><span class="p">(</span><span class="n">action</span><span class="p">:</span> <span class="n">ActionCommandInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute action via puppeteer.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">puppeteer</span><span class="p">,</span> <span class="n">control_dict</span><span class="o">=</span><span class="p">{})</span>

    <span class="c1"># Create FastMCP instance</span>
    <span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;YourApp COM Executor MCP Server&quot;</span><span class="p">)</span>

    <span class="c1"># Define tools below...</span>

    <span class="k">return</span> <span class="n">mcp</span>
</code></pre></div>
<h3 id="step-2-define-tool-methods-with-mcptool">Step 2: Define Tool Methods with @mcp.tool()</h3>
<p>Add tool methods to your MCP server using the <code>@mcp.tool()</code> decorator. Each tool wraps a native API call:</p>
<div class="highlight"><pre><span></span><code>    <span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">insert_data_table</span><span class="p">(</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;2D array of table data. Example: [[&#39;Name&#39;, &#39;Age&#39;], [&#39;Alice&#39;, &#39;25&#39;]]&quot;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">start_row</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="nb">int</span><span class="p">,</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Starting row index (1-based).&quot;</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">start_col</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="nb">int</span><span class="p">,</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Starting column index (1-based).&quot;</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Result message.&quot;</span><span class="p">)]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert a data table into the application at the specified position.</span>
<span class="sd">        Use this for bulk data insertion instead of manual cell-by-cell input.</span>

<span class="sd">        Example usage:</span>
<span class="sd">        - Insert CSV data: insert_data_table(data=csv_data, start_row=1, start_col=1)</span>
<span class="sd">        - Add header and rows: insert_data_table(data=[[&#39;ID&#39;, &#39;Name&#39;], [&#39;1&#39;, &#39;Alice&#39;], [&#39;2&#39;, &#39;Bob&#39;]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">ActionCommandInfo</span><span class="p">(</span>
            <span class="n">function</span><span class="o">=</span><span class="s2">&quot;insert_table&quot;</span><span class="p">,</span>
            <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                <span class="s2">&quot;start_row&quot;</span><span class="p">:</span> <span class="n">start_row</span><span class="p">,</span>
                <span class="s2">&quot;start_col&quot;</span><span class="p">:</span> <span class="n">start_col</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_execute_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

    <span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_range</span><span class="p">(</span>
        <span class="n">start_cell</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Starting cell address (e.g., &#39;A1&#39;).&quot;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">end_cell</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Ending cell address (e.g., &#39;B10&#39;).&quot;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">font_bold</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Make font bold?&quot;</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">font_size</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Font size in points.&quot;</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">background_color</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Background color (hex code like &#39;#FF0000&#39; for red).&quot;</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Formatting result.&quot;</span><span class="p">)]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply formatting to a cell range in the application.</span>
<span class="sd">        Much faster than clicking format buttons multiple times.</span>

<span class="sd">        Example:</span>
<span class="sd">        - Bold header: format_range(start_cell=&#39;A1&#39;, end_cell=&#39;E1&#39;, font_bold=True)</span>
<span class="sd">        - Highlight cells: format_range(start_cell=&#39;A2&#39;, end_cell=&#39;A10&#39;, background_color=&#39;#FFFF00&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">ActionCommandInfo</span><span class="p">(</span>
            <span class="n">function</span><span class="o">=</span><span class="s2">&quot;format_cells&quot;</span><span class="p">,</span>
            <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;start_cell&quot;</span><span class="p">:</span> <span class="n">start_cell</span><span class="p">,</span>
                <span class="s2">&quot;end_cell&quot;</span><span class="p">:</span> <span class="n">end_cell</span><span class="p">,</span>
                <span class="s2">&quot;font_bold&quot;</span><span class="p">:</span> <span class="n">font_bold</span><span class="p">,</span>
                <span class="s2">&quot;font_size&quot;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">,</span>
                <span class="s2">&quot;background_color&quot;</span><span class="p">:</span> <span class="n">background_color</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_execute_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

    <span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_as_pdf</span><span class="p">(</span>
        <span class="n">output_path</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> 
            <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Full path for the PDF file (e.g., &#39;C:/Users/Documents/report.pdf&#39;).&quot;</span><span class="p">)</span>
        <span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Save result message.&quot;</span><span class="p">)]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export the current document as a PDF file.</span>
<span class="sd">        One-click operation - much faster than File &gt; Save As &gt; PDF &gt; Navigate &gt; Save.</span>

<span class="sd">        Example: save_as_pdf(output_path=&#39;C:/Reports/monthly_report.pdf&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">ActionCommandInfo</span><span class="p">(</span>
            <span class="n">function</span><span class="o">=</span><span class="s2">&quot;save_as&quot;</span><span class="p">,</span>
            <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="n">output_path</span><span class="p">,</span>
                <span class="s2">&quot;file_format&quot;</span><span class="p">:</span> <span class="s2">&quot;pdf&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_execute_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tool Design Best Practices</p>
<ul>
<li><strong>Clear docstrings</strong>: Explain what the tool does, when to use it, and provide examples</li>
<li><strong>Descriptive parameters</strong>: Use <code>Annotated</code> with <code>Field(description=...)</code>for all parameters</li>
<li><strong>Error handling</strong>: Return descriptive error messages when operations fail</li>
<li><strong>Comprehensive coverage</strong>: Wrap common operations that benefit from API speed</li>
</ul>
</div>
<h3 id="step-3-implement-the-underlying-api-receiver">Step 3: Implement the Underlying API Receiver</h3>
<p>The receiver class executes the actual COM API calls. Create it in <code>ufo/automator/app_apis/</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># File: ufo/automator/app_apis/your_app/your_app_client.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">win32com.client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.automator.app_apis.basic</span><span class="w"> </span><span class="kn">import</span> <span class="n">WinCOMReceiverBasic</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.automator.basic</span><span class="w"> </span><span class="kn">import</span> <span class="n">CommandBasic</span>


<span class="k">class</span><span class="w"> </span><span class="nc">YourAppCOMReceiver</span><span class="p">(</span><span class="n">WinCOMReceiverBasic</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    COM API receiver for YourApp automation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_command_registry</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">CommandBasic</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_root_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">process_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the YourApp COM client.</span>
<span class="sd">        :param app_root_name: Application root name.</span>
<span class="sd">        :param process_name: Process name.</span>
<span class="sd">        :param clsid: COM object CLSID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">app_root_name</span><span class="p">,</span> <span class="n">process_name</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_table_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> 
        <span class="n">start_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
        <span class="n">start_col</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert table data using COM API.</span>
<span class="sd">        :param data: 2D array of table data.</span>
<span class="sd">        :param start_row: Starting row (1-based).</span>
<span class="sd">        :param start_col: Starting column (1-based).</span>
<span class="sd">        :return: Result message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Access the active document/workbook via COM</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">com_object</span><span class="o">.</span><span class="n">ActiveDocument</span>  <span class="c1"># Or ActiveWorkbook for Excel</span>

            <span class="c1"># Insert data row by row</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">cell_value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                    <span class="c1"># Example: Set cell value</span>
                    <span class="n">cell</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">Tables</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">start_row</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">start_col</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">Range</span><span class="o">.</span><span class="n">Text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell_value</span><span class="p">)</span>

            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Successfully inserted </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows of data&quot;</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error inserting table: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_cells</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start_cell</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">end_cell</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">font_bold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">font_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">background_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format cell range using COM API.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">com_object</span><span class="o">.</span><span class="n">ActiveDocument</span>
            <span class="n">range_obj</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="n">start_cell</span><span class="p">,</span> <span class="n">end_cell</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">font_bold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">range_obj</span><span class="o">.</span><span class="n">Font</span><span class="o">.</span><span class="n">Bold</span> <span class="o">=</span> <span class="n">font_bold</span>
            <span class="k">if</span> <span class="n">font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">range_obj</span><span class="o">.</span><span class="n">Font</span><span class="o">.</span><span class="n">Size</span> <span class="o">=</span> <span class="n">font_size</span>
            <span class="k">if</span> <span class="n">background_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Convert hex to RGB and apply</span>
                <span class="n">range_obj</span><span class="o">.</span><span class="n">Shading</span><span class="o">.</span><span class="n">BackgroundPatternColor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hex_to_rgb</span><span class="p">(</span><span class="n">background_color</span><span class="p">)</span>

            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Successfully formatted range </span><span class="si">{</span><span class="n">start_cell</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">end_cell</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error formatting cells: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_document_as</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save document in specified format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">com_object</span><span class="o">.</span><span class="n">ActiveDocument</span>

            <span class="c1"># Map format string to COM constant</span>
            <span class="n">format_map</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;pdf&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>  <span class="c1"># wdFormatPDF</span>
                <span class="s2">&quot;docx&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>  <span class="c1"># wdFormatXMLDocument</span>
                <span class="c1"># Add more formats as needed</span>
            <span class="p">}</span>

            <span class="n">format_code</span> <span class="o">=</span> <span class="n">format_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_format</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">SaveAs2</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">FileFormat</span><span class="o">=</span><span class="n">format_code</span><span class="p">)</span>

            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Successfully saved document to </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error saving document: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_hex_to_rgb</span><span class="p">(</span><span class="n">hex_color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert hex color to RGB integer for COM.&quot;&quot;&quot;</span>
        <span class="n">hex_color</span> <span class="o">=</span> <span class="n">hex_color</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_color</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="p">(</span><span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-4-create-command-classes">Step 4: Create Command Classes</h3>
<p>Define command classes that bridge the MCP tools to the receiver methods:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In the same file: ufo/automator/app_apis/your_app/your_app_client.py</span>

<span class="nd">@YourAppCOMReceiver</span><span class="o">.</span><span class="n">register</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InsertTableCommand</span><span class="p">(</span><span class="n">CommandBasic</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Command to insert table data.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute table insertion.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver</span><span class="o">.</span><span class="n">insert_table_data</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="n">start_row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_row&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">start_col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_col&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>


<span class="nd">@YourAppCOMReceiver</span><span class="o">.</span><span class="n">register</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FormatCellsCommand</span><span class="p">(</span><span class="n">CommandBasic</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Command to format cell range.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute cell formatting.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver</span><span class="o">.</span><span class="n">format_cells</span><span class="p">(</span>
            <span class="n">start_cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_cell&quot;</span><span class="p">),</span>
            <span class="n">end_cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end_cell&quot;</span><span class="p">),</span>
            <span class="n">font_bold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;font_bold&quot;</span><span class="p">),</span>
            <span class="n">font_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;font_size&quot;</span><span class="p">),</span>
            <span class="n">background_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;background_color&quot;</span><span class="p">),</span>
        <span class="p">)</span>


<span class="nd">@YourAppCOMReceiver</span><span class="o">.</span><span class="n">register</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SaveAsCommand</span><span class="p">(</span><span class="n">CommandBasic</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Command to save document.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute document save.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">receiver</span><span class="o">.</span><span class="n">save_document_as</span><span class="p">(</span>
            <span class="n">file_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_path&quot;</span><span class="p">),</span>
            <span class="n">file_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_format&quot;</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Command Registration</p>
<p>Use <code>@YourAppCOMReceiver.register</code> decorator to register each command class with the receiver.</p>
</div>
<h3 id="step-5-register-your-receiver-in-the-factory">Step 5: Register Your Receiver in the Factory</h3>
<p>Add your receiver to the COM receiver factory in <code>ufo/automator/app_apis/factory.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__com_client_mapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_root_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">WinCOMReceiverBasic</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Map application to its COM receiver class.&quot;&quot;&quot;</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;WINWORD.EXE&quot;</span><span class="p">:</span> <span class="n">WordWinCOMReceiver</span><span class="p">,</span>
        <span class="s2">&quot;EXCEL.EXE&quot;</span><span class="p">:</span> <span class="n">ExcelWinCOMReceiver</span><span class="p">,</span>
        <span class="s2">&quot;POWERPNT.EXE&quot;</span><span class="p">:</span> <span class="n">PowerPointWinCOMReceiver</span><span class="p">,</span>
        <span class="s2">&quot;YOURAPP.EXE&quot;</span><span class="p">:</span> <span class="n">YourAppCOMReceiver</span><span class="p">,</span>  <span class="c1"># Add your app here</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">app_root_name</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">__app_root_mappping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_root_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Map application to its COM CLSID.&quot;&quot;&quot;</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;WINWORD.EXE&quot;</span><span class="p">:</span> <span class="s2">&quot;Word.Application&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXCEL.EXE&quot;</span><span class="p">:</span> <span class="s2">&quot;Excel.Application&quot;</span><span class="p">,</span>
        <span class="s2">&quot;POWERPNT.EXE&quot;</span><span class="p">:</span> <span class="s2">&quot;PowerPoint.Application&quot;</span><span class="p">,</span>
        <span class="s2">&quot;YOURAPP.EXE&quot;</span><span class="p">:</span> <span class="s2">&quot;YourApp.Application&quot;</span><span class="p">,</span>  <span class="c1"># Add your CLSID here</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">app_root_name</span><span class="p">)</span>
</code></pre></div>
<h3 id="step-6-register-the-mcp-server-in-mcpyaml">Step 6: Register the MCP Server in mcp.yaml</h3>
<p>Configure the MCP server for your application in <code>config/ufo/mcp.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AppAgent</span><span class="p">:</span>
<span class="w">  </span><span class="nt">YOURAPP.EXE</span><span class="p">:</span>
<span class="w">    </span><span class="nt">data_collection</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UICollector</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<span class="w">        </span><span class="nt">reset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">action</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AppUIExecutor</span><span class="w">  </span><span class="c1"># Generic UI automation</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<span class="w">        </span><span class="nt">reset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">YourAppExecutor</span><span class="w">  </span><span class="c1"># Your custom COM API tools</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<span class="w">        </span><span class="nt">reset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># Reset COM state when switching documents</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CommandLineExecutor</span><span class="w">  </span><span class="c1"># Shell commands</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<span class="w">        </span><span class="nt">reset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Why <code>reset: true</code>?</p>
<p>Set <code>reset: true</code> for COM-based MCP servers to prevent state leakage when switching between documents or application instances.</p>
</div>
<h3 id="step-7-test-your-mcp-server">Step 7: Test Your MCP Server</h3>
<p>Test your server in isolation before integration:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># File: test_your_app_server.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastmcp.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ufo.client.mcp.local_servers.your_app_executor</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_your_app_executor</span>


<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_server</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test YourApp MCP server.&quot;&quot;&quot;</span>
    <span class="n">process_name</span> <span class="o">=</span> <span class="s2">&quot;your_app_process&quot;</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">create_your_app_executor</span><span class="p">(</span><span class="n">process_name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">Client</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
        <span class="c1"># List available tools</span>
        <span class="n">tools</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available tools: </span><span class="si">{</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tools</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Test insert_data_table</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">call_tool</span><span class="p">(</span>
            <span class="s2">&quot;insert_data_table&quot;</span><span class="p">,</span>
            <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;25&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;30&quot;</span><span class="p">]],</span>
                <span class="s2">&quot;start_row&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;start_col&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Insert result: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Test format_range</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">call_tool</span><span class="p">(</span>
            <span class="s2">&quot;format_range&quot;</span><span class="p">,</span>
            <span class="n">arguments</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;start_cell&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;end_cell&quot;</span><span class="p">:</span> <span class="s2">&quot;B1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;font_bold&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;font_size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Format result: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_server</span><span class="p">())</span>
</code></pre></div>
<h2 id="complete-example-excel-com-executor">Complete Example: Excel COM Executor</h2>
<p>See the complete implementation in UFO²'s codebase:</p>
<ul>
<li><strong>MCP Server</strong>: <code>ufo/client/mcp/local_servers/excel_wincom_mcp_server.py</code></li>
<li><strong>COM Receiver</strong>: <code>ufo/automator/app_apis/excel/excel_client.py</code></li>
<li><strong>Configuration</strong>: <code>config/ufo/mcp.yaml</code> (under <code>AppAgent.EXCEL.EXE</code>)</li>
</ul>
<p>Key features:
- <code>insert_table</code>: Bulk data insertion
- <code>format_cells</code>: Cell formatting (fonts, colors, borders)
- <code>create_chart</code>: Chart generation
- <code>apply_formula</code>: Formula application
- <code>save_as</code>: Export to PDF/CSV</p>
<h2 id="legacy-approach-api-prompt-files-deprecated">Legacy Approach: API Prompt Files (Deprecated)</h2>
<div class="admonition warning">
<p class="admonition-title">Deprecated: API Prompt Files</p>
<p>The old approach of creating <code>api.yaml</code> prompt files and configuring <code>APP_API_PROMPT_ADDRESS</code> is <strong>deprecated</strong>. The new MCP architecture provides:</p>
<ul>
<li>✅ <strong>Better tool discovery</strong>: Tools are automatically introspected from MCP servers</li>
<li>✅ <strong>Type safety</strong>: Pydantic models ensure parameter validation</li>
<li>✅ <strong>Cleaner code</strong>: No manual prompt file maintenance</li>
<li>✅ <strong>Better testing</strong>: Direct server testing with FastMCP Client</li>
</ul>
<p>If you're migrating from the old system, see <a href="../../creating_mcp_servers/">Creating MCP Servers Tutorial</a>.</p>
</div>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-comprehensive-docstrings">1. Comprehensive Docstrings</h3>
<div class="highlight"><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">insert_data_table</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">...</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Insert a data table into the application at the specified position.</span>
<span class="sd">    Use this for bulk data insertion instead of manual cell-by-cell input.</span>

<span class="sd">    When to use:</span>
<span class="sd">    - Inserting CSV/Excel data</span>
<span class="sd">    - Creating tables from lists</span>
<span class="sd">    - Bulk data population</span>

<span class="sd">    Example usage:</span>
<span class="sd">    - Insert CSV data: insert_data_table(data=csv_data, start_row=1, start_col=1)</span>
<span class="sd">    - Add header and rows: insert_data_table(data=[[&#39;ID&#39;, &#39;Name&#39;], [&#39;1&#39;, &#39;Alice&#39;]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="2-error-handling">2. Error Handling</h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">insert_table_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert table data using COM API.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Validate input</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s2">&quot;Error: Empty data table provided&quot;</span>

        <span class="c1"># Execute COM operation</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">com_object</span><span class="o">.</span><span class="n">ActiveDocument</span>
        <span class="c1"># ... insert logic ...</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Successfully inserted </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows&quot;</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error inserting table: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<h3 id="3-parameter-validation">3. Parameter Validation</h3>
<div class="highlight"><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">format_range</span><span class="p">(</span>
    <span class="n">start_cell</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> 
        <span class="n">Field</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Starting cell address (e.g., &#39;A1&#39;). Must be valid Excel notation.&quot;</span><span class="p">,</span>
            <span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;^[A-Z]+[0-9]+$&quot;</span>  <span class="c1"># Regex validation</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="o">...</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="o">...</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format cell range.&quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="4-fallback-to-ui-automation">4. Fallback to UI Automation</h3>
<p>Design your API tools to complement (not replace) UI automation:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_table_style</span><span class="p">(</span><span class="n">style_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply a predefined table style.</span>

<span class="sd">    Note: For custom styling, use format_range() or UI automation</span>
<span class="sd">    via AppUIExecutor::click_input() on the Design tab.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="issue-com-object-not-found">Issue: COM Object Not Found</h3>
<p><strong>Symptom</strong>: <code>pywintypes.com_error: (-2147221005, 'Invalid class string', None, None)</code></p>
<p><strong>Solution</strong>:
1. Verify the CLSID is correct for your application
2. Ensure the application is installed and registered
3. Check if the application supports COM automation</p>
<h3 id="issue-permission-denied">Issue: Permission Denied</h3>
<p><strong>Symptom</strong>: <code>com_error: (-2147352567, 'Exception occurred.', ...)</code></p>
<p><strong>Solution</strong>:
- Run UFO² with administrator privileges
- Check application security settings
- Verify COM permissions in <code>dcomcnfg</code></p>
<h3 id="issue-tools-not-appearing-in-llm-prompt">Issue: Tools Not Appearing in LLM Prompt</h3>
<p><strong>Symptom</strong>: AppAgent doesn't use your API tools</p>
<p><strong>Solution</strong>:
1. Verify MCP server is registered in <code>mcp.yaml</code>
2. Check namespace matches: <code>@MCPRegistry.register_factory_decorator("YourAppExecutor")</code>
3. Ensure server is under <code>action:</code> (not <code>data_collection:</code>)
4. Test server independently with FastMCP Client</p>
<h2 id="related-documentation">Related Documentation</h2>
<p><strong>Core Tutorials:</strong></p>
<ul>
<li><strong><a href="../../creating_mcp_servers/">Creating MCP Servers Tutorial</a></strong> - Complete MCP server development guide</li>
<li><a href="../overview/">Overview: Enhancing AppAgent Capabilities</a> - Learn about all enhancement approaches</li>
<li><a href="../help_document_provision/">Help Document Provision</a> - Provide knowledge through documentation</li>
<li><a href="../demonstration_provision/">User Demonstrations Provision</a> - Teach through examples</li>
</ul>
<p><strong>MCP Documentation:</strong></p>
<ul>
<li><a href="../../../mcp/configuration/">MCP Configuration</a> - Registering MCP servers</li>
<li><a href="../../../mcp/overview/">MCP Overview</a> - Understanding MCP architecture</li>
<li><a href="../../../mcp/servers/word_com_executor/">WordCOMExecutor</a> - Reference implementation</li>
<li><a href="../../../mcp/servers/excel_com_executor/">ExcelCOMExecutor</a> - Reference implementation</li>
</ul>
<p><strong>Advanced Features:</strong></p>
<ul>
<li><a href="../../../ufo2/core_features/hybrid_actions/">Hybrid GUI–API Actions</a> - How AppAgent chooses tools</li>
<li><a href="../../../ufo2/core_features/knowledge_substrate/overview/">Knowledge Substrate Overview</a> - Understanding the RAG architecture</li>
</ul>
<hr />
<p>By following this guide, you've successfully wrapped your application's native API as an MCP action server, enabling the AppAgent to perform fast, reliable automation through direct API calls!</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../demonstration_provision/" class="btn btn-neutral float-left" title="Demonstration Provision"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../../infrastructure/modules/overview/" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../demonstration_provision/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../../infrastructure/modules/overview/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      <script src="../../../javascripts/mermaid-init.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
