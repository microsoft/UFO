<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Warpping App-Native API - UFO Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Warpping App-Native API";
        var mkdocs_page_input_path = "creating_app_agent/warpping_app_native_api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> UFO Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../project_directory_structure/">Project Directory Structure</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/more_guidance/">More Guidance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Basic Modules</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/session/">Session</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/round/">Round</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/context/">Context</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configurations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/user_configuration/">User Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/developer_configuration/">Developer Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/pricing_configuration/">Model Pricing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Supported Models</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/openai/">OpenAI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/azure_openai/">Azure OpenAI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/operator/">OpenAI CUA (Operator)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/gemini/">Gemini</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/claude/">Claude</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/qwen/">Qwen</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/deepseek/">DeepSeek</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/ollama/">Ollama</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/custom_model/">Custom Model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agents</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Agent Design</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/memory/">Memory</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/blackboard/">Blackboard</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/state/">State</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/prompter/">Prompter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/design/processor/">Processor</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/host_agent/">HostAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/app_agent/">AppAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/follower_agent/">FollowerAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../agents/evaluation_agent/">EvaluationAgent</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Prompts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/basic_template/">Basic Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/examples_prompts/">Examples Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/api_prompts/">API Prompts</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Puppeteer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/ui_automator/">GUI Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/wincom_automator/">API Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/web_automator/">Web Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/bash_automator/">Bash Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/ai_tool_automator/">AI Tool</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Logs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/markdown_log_viewer/">Markdown Log Viewer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/request_logs/">Request Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/step_logs/">Step Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/evaluation_logs/">Evaluation Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/screenshots_logs/">Screenshots</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/ui_tree_logs/">UI Tree</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Continuous Knowledge Substrate</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_help_document/">Learning from Help Document</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_bing_search/">Learning from Bing Search</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/experience_learning/">Experience Learning</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_demonstration/">Learning from User Demonstration</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/follower_mode/">Follower Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/batch_mode/">Batch Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/multi_action/">Speculative Multi-Action Execution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/operator_as_app_agent/">Operator-as-a-AppAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Control Filtering</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/text_filtering/">Text Filtering</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/semantic_filtering/">Semantic Filtering</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/icon_filtering/">Icon Filtering</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Control Detection</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/uia_detection/">UIA Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/visual_detection/">Visual Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/hybrid_detection/">Hybrid Detection</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/customization/">Customization</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Creating Your AppAgent</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../help_document_provision/">Help Document Provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../demonstration_provision/">Demonstration Provision</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Warpping App-Native API</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#how-to-wrap-your-apps-native-api">How to Wrap Your App's Native API?</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#step-1-create-a-receiver-for-the-native-api">Step 1: Create a Receiver for the Native API</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-create-a-folder-for-your-application">1. Create a Folder for Your Application</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-create-a-python-file">2. Create a Python File</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-define-the-receiver-class">3. Define the Receiver Class</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#4-define-methods-to-execute-native-api-calls">4. Define Methods to Execute Native API Calls</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#5-create-a-factory-class">5. Create a Factory Class</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-2-create-a-command-for-the-native-api">Step 2: Create a Command for the Native API</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-create-a-command-class">1. Create a Command Class</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-define-the-execute-method">2. Define the Execute Method</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-3-provide-prompt-descriptions-for-the-native-api">Step 3: Provide Prompt Descriptions for the Native API</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-create-an-apiyaml-file">1. Create an api.yaml File</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-define-prompt-descriptions">2. Define Prompt Descriptions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-register-the-prompt-address-in-config_devyaml">3. Register the Prompt Address in config_dev.yaml</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Benchmark</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/windows_agent_arena/">Windows Agent Arena</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/osworld/">OSWorld (Windows)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Dataflow</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/instantiation/">Instantiation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/execution/">Execution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/windows_app_env/">Windows App Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/result/">Result</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/LICENSE/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/CODE_OF_CONDUCT/">Code of Conduct</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/DISCLAIMER/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/SUPPORT/">Support</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">UFO Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Creating Your AppAgent</li>
      <li class="breadcrumb-item active">Warpping App-Native API</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="wrapping-your-apps-native-api">Wrapping Your App's Native API</h1>
<p>UFO takes actions on applications based on UI controls, but providing native API to its toolboxes can enhance the efficiency and accuracy of the actions. This document provides guidance on how to wrap your application's native API into UFO's toolboxes.</p>
<h2 id="how-to-wrap-your-apps-native-api">How to Wrap Your App's Native API?</h2>
<p>Before developing the native API wrappers, we strongly recommend that you read the design of the <a href="../../automator/overview/">Automator</a>.</p>
<h3 id="step-1-create-a-receiver-for-the-native-api">Step 1: Create a Receiver for the Native API</h3>
<p>The <code>Receiver</code> is a class that receives the native API calls from the <code>AppAgent</code> and executes them. To wrap your application's native API, you need to create a <code>Receiver</code> class that contains the methods to execute the native API calls.</p>
<p>To create a <code>Receiver</code> class, follow these steps:</p>
<h4 id="1-create-a-folder-for-your-application">1. Create a Folder for Your Application</h4>
<ul>
<li>Navigate to the <code>ufo/automator/app_api/</code> directory.</li>
<li>Create a folder named after your application.</li>
</ul>
<h4 id="2-create-a-python-file">2. Create a Python File</h4>
<ul>
<li>Inside the folder you just created, add a Python file named after your application, for example, <code>{your_application}_client.py</code>.</li>
</ul>
<h4 id="3-define-the-receiver-class">3. Define the Receiver Class</h4>
<ul>
<li>In the Python file, define a class named <code>{Your_Receiver}</code>, inheriting from the <code>ReceiverBasic</code> class located in <code>ufo/automator/basic.py</code>.</li>
<li>Initialize the <code>Your_Receiver</code> class with the object that executes the native API calls. For example, if your API is based on a <code>com</code> object, initialize the <code>com</code> object in the <code>__init__</code> method of the <code>Your_Receiver</code> class.</li>
</ul>
<p>Example of <code>WinCOMReceiverBasic</code> class:</p>
<pre><code class="language-python">class WinCOMReceiverBasic(ReceiverBasic):
    &quot;&quot;&quot;
    The base class for Windows COM client.
    &quot;&quot;&quot;

    _command_registry: Dict[str, Type[CommandBasic]] = {}

    def __init__(self, app_root_name: str, process_name: str, clsid: str) -&gt; None:
        &quot;&quot;&quot;
        Initialize the Windows COM client.
        :param app_root_name: The app root name.
        :param process_name: The process name.
        :param clsid: The CLSID of the COM object.
        &quot;&quot;&quot;

        self.app_root_name = app_root_name
        self.process_name = process_name
        self.clsid = clsid
        self.client = win32com.client.Dispatch(self.clsid)
        self.com_object = self.get_object_from_process_name()
</code></pre>
<hr />
<h4 id="4-define-methods-to-execute-native-api-calls">4. Define Methods to Execute Native API Calls</h4>
<ul>
<li>Define the methods in the <code>Your_Receiver</code> class to execute the native API calls.</li>
</ul>
<p>Example of <code>ExcelWinCOMReceiver</code> class:</p>
<pre><code class="language-python">def table2markdown(self, sheet_name: str) -&gt; str:
    &quot;&quot;&quot;
    Convert the table in the sheet to a markdown table string.
    :param sheet_name: The sheet name.
    :return: The markdown table string.
    &quot;&quot;&quot;

    sheet = self.com_object.Sheets(sheet_name)
    data = sheet.UsedRange()
    df = pd.DataFrame(data[1:], columns=data[0])
    df = df.dropna(axis=0, how=&quot;all&quot;)
    df = df.applymap(self.format_value)

    return df.to_markdown(index=False)
</code></pre>
<hr />
<h4 id="5-create-a-factory-class">5. Create a Factory Class</h4>
<ul>
<li>Create your Factory class inheriting from the <code>APIReceiverFactory</code> class to manage multiple <code>Receiver</code> classes that share the same API type.</li>
<li>Implement the <code>create_receiver</code> and <code>name</code> methods in the <code>ReceiverFactory</code> class. The <code>create_receiver</code> method should return the <code>Receiver</code> class.</li>
<li>By default, the <code>create_receiver</code> takes the <code>app_root_name</code> and <code>process_name</code> as parameters and returns the <code>Receiver</code> class.</li>
<li>Register the <code>ReceiverFactory</code> class with the decorator <code>@ReceiverManager.register</code>.</li>
</ul>
<p>Example of the <code>COMReceiverFactory</code> class:</p>
<pre><code class="language-python">from ufo.automator.puppeteer import ReceiverManager

@ReceiverManager.register
class COMReceiverFactory(APIReceiverFactory):
    &quot;&quot;&quot;
    The factory class for the COM receiver.
    &quot;&quot;&quot;

    def create_receiver(self, app_root_name: str, process_name: str) -&gt; WinCOMReceiverBasic:
        &quot;&quot;&quot;
        Create the wincom receiver.
        :param app_root_name: The app root name.
        :param process_name: The process name.
        :return: The receiver.
        &quot;&quot;&quot;

        com_receiver = self.__com_client_mapper(app_root_name)
        clsid = self.__app_root_mappping(app_root_name)

        if clsid is None or com_receiver is None:
            # print_with_color(f&quot;Warning: Win32COM API is not supported for {process_name}.&quot;, &quot;yellow&quot;)
            return None

        return com_receiver(app_root_name, process_name, clsid)

    @classmethod
    def name(cls) -&gt; str:
        &quot;&quot;&quot;
        Get the name of the receiver factory.
        :return: The name of the receiver factory.
        &quot;&quot;&quot;
        return &quot;COM&quot;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>create_receiver</code> method should return <code>None</code> if the application is not supported.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must register your <code>ReceiverFactory</code> with the decorator <code>@ReceiverManager.register</code> for the <code>ReceiverManager</code> to manage the <code>ReceiverFactory</code>.</p>
</div>
<p>The <code>Receiver</code> class is now ready to receive the native API calls from the <code>AppAgent</code>.</p>
<h3 id="step-2-create-a-command-for-the-native-api">Step 2: Create a Command for the Native API</h3>
<p>Commands are the actions that the <code>AppAgent</code> can execute on the application. To create a command for the native API, you need to create a <code>Command</code> class that contains the method to execute the native API calls.</p>
<h4 id="1-create-a-command-class">1. Create a Command Class</h4>
<ul>
<li>Create a <code>Command</code> class in the same Python file where the <code>Receiver</code> class is located. The <code>Command</code> class should inherit from the <code>CommandBasic</code> class located in <code>ufo/automator/basic.py</code>.</li>
</ul>
<p>Example:</p>
<pre><code class="language-python">class WinCOMCommand(CommandBasic):
    &quot;&quot;&quot;
    The abstract command interface.
    &quot;&quot;&quot;

    def __init__(self, receiver: WinCOMReceiverBasic, params=None) -&gt; None:
        &quot;&quot;&quot;
        Initialize the command.
        :param receiver: The receiver of the command.
        &quot;&quot;&quot;
        self.receiver = receiver
        self.params = params if params is not None else {}

    @abstractmethod
    def execute(self):
        pass

    @classmethod
    def name(cls) -&gt; str:
        &quot;&quot;&quot;
        Get the name of the command.
        :return: The name of the command.
        &quot;&quot;&quot;
        return cls.__name__
</code></pre>
<hr />
<h4 id="2-define-the-execute-method">2. Define the Execute Method</h4>
<ul>
<li>Define the <code>execute</code> method in the <code>Command</code> class to call the receiver to execute the native API calls.</li>
</ul>
<p>Example:</p>
<pre><code class="language-python">def execute(self):
    &quot;&quot;&quot;
    Execute the command to insert a table.
    :return: The inserted table.
    &quot;&quot;&quot;
    return self.receiver.insert_excel_table(
        sheet_name=self.params.get(&quot;sheet_name&quot;, 1),
        table=self.params.get(&quot;table&quot;),
        start_row=self.params.get(&quot;start_row&quot;, 1),
        start_col=self.params.get(&quot;start_col&quot;, 1),
    )
</code></pre>
<p><strong>3. Register the Command Class:</strong></p>
<ul>
<li>Register the <code>Command</code> class in the corresponding <code>Receiver</code> class using the <code>@your_receiver.register</code> decorator.</li>
</ul>
<p>Example:</p>
<pre><code class="language-python">@ExcelWinCOMReceiver.register
class InsertExcelTable(WinCOMCommand):
    ...
</code></pre>
<p>The <code>Command</code> class is now registered in the <code>Receiver</code> class and available for the <code>AppAgent</code> to execute the native API calls.</p>
<h3 id="step-3-provide-prompt-descriptions-for-the-native-api">Step 3: Provide Prompt Descriptions for the Native API</h3>
<p>To let the <code>AppAgent</code> know the usage of the native API calls, you need to provide prompt descriptions.</p>
<h4 id="1-create-an-apiyaml-file">1. Create an api.yaml File</h4>
<pre><code>- Create an `api.yaml` file in the `ufo/prompts/apps/{your_app_name}` directory.
</code></pre>
<h4 id="2-define-prompt-descriptions">2. Define Prompt Descriptions</h4>
<ul>
<li>Define the prompt descriptions for the native API calls in the <code>api.yaml</code> file.</li>
</ul>
<p>Example:</p>
<pre><code class="language-yaml">table2markdown:
summary: |-
    &quot;table2markdown&quot; is to get the table content in a sheet of the Excel app and convert it to markdown format.
class_name: |-
    GetSheetContent
usage: |-
    [1] API call: table2markdown(sheet_name: str)
    [2] Args:
    - sheet_name: The name of the sheet in the Excel app.
    [3] Example: table2markdown(sheet_name=&quot;Sheet1&quot;)
    [4] Available control item: Any control item in the Excel app.
    [5] Return: the markdown format string of the table content of the sheet.
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>table2markdown</code> is the name of the native API call. It <code>MUST</code> match the <code>name()</code> defined in the corresponding <code>Command</code> class!</p>
</div>
<h4 id="3-register-the-prompt-address-in-config_devyaml">3. Register the Prompt Address in <code>config_dev.yaml</code></h4>
<ul>
<li>Register the prompt address by adding to the <code>APP_API_PROMPT_ADDRESS</code> field of <code>config_dev.yaml</code> file with the application program name as the key and the prompt file address as the value.</li>
</ul>
<p>Example:</p>
<pre><code class="language-yaml">APP_API_PROMPT_ADDRESS: {
    &quot;WINWORD.EXE&quot;: &quot;ufo/prompts/apps/word/api.yaml&quot;,
    &quot;EXCEL.EXE&quot;: &quot;ufo/prompts/apps/excel/api.yaml&quot;,
    &quot;msedge.exe&quot;: &quot;ufo/prompts/apps/web/api.yaml&quot;,
    &quot;chrome.exe&quot;: &quot;ufo/prompts/apps/web/api.yaml&quot;
    &quot;your_application_program_name&quot;: &quot;YOUR_APPLICATION_API_PROMPT&quot;
} 
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>your_application_program_name</code> <strong>must</strong> match the name of the application program.</p>
</div>
<p>The <code>AppAgent</code> can now use the prompt descriptions to understand the usage of the native API calls.</p>
<hr />
<p>By following these steps, you will have successfully wrapped the native API of your application into UFO's toolboxes, allowing the <code>AppAgent</code> to execute the native API calls on the application!</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../demonstration_provision/" class="btn btn-neutral float-left" title="Demonstration Provision"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../benchmark/overview/" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../demonstration_provision/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../benchmark/overview/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
