<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Session - UFO³ Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Session";
        var mkdocs_page_input_path = "infrastructure/modules/session.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> UFO³ Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../choose_path/">Choose Your Path</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../project_directory_structure/">Project Directory Structure</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_galaxy/">Quick Start (UFO³ Agent Galaxy)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_ufo2/">Quick Start (UFO²)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_linux/">Quick Start (Linux Agent)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_mobile/">Quick Start (Mobile Agent)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/migration_ufo2_to_galaxy/">Migration UFO² → UFO³</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/more_guidance/">More Guidance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration & Setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Configuration System</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/agents_config/">Agent Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/system_config/">System Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/rag_config/">RAG Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/prices_config/">Pricing Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/third_party_config/">Third-Party Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/mcp_reference/">MCP Reference</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/migration/">Migration Guide</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/extending/">Extending Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Galaxy Configuration</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_devices/">Devices</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_constellation/">Constellation</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_agent/">Agent</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Model Setup</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/openai/">OpenAI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/azure_openai/">Azure OpenAI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/operator/">OpenAI CUA (Operator)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/gemini/">Gemini</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/claude/">Claude</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/qwen/">Qwen</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/deepseek/">DeepSeek</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/ollama/">Ollama</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/custom_model/">Custom Model</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UFO³ Agent Galaxy</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../galaxy/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../galaxy/webui/">WebUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Galaxy Client</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/constellation_client/">ConstellationClient</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/device_manager/">DeviceManager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/components/">Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/aip_integration/">AIP Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/galaxy_client/">GalaxyClient</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Agent Registration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/agent_profile/">Agent Profile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/device_registry/">Device Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/registration_flow/">Registration Flow</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Task Constellation (DAG)</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_star/">TaskStar</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_star_line/">TaskStarLine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_constellation/">TaskConstellation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/constellation_editor/">ConstellationEditor</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Constellation Agent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/strategy/">Strategy Pattern</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/command/">MCP Commands</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Constellation Orchestrator</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/event_driven_coordination/">Event-Driven Coordination</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/asynchronous_scheduling/">Asynchronous Scheduling</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/safe_assignment_locking/">Safe Assignment Locking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/consistency_guarantees/">Consistency Guarantees</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/batched_editing/">Batched Editing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/constellation_manager/">Constellation Manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/api_reference/">API Reference</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Observer System</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/event_system/">Event System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/progress_observer/">Progress Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/agent_output_observer/">Agent Output Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/synchronizer/">Synchronizer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/metrics_observer/">Metrics Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/visualization_observer/">Visualization Observer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation & Logging</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/trajectory_report/">Trajectory Report</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/performance_metrics/">Performance Metrics</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/result_json/">Result JSON Reference</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UFO² Desktop AgentOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ufo2/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../ufo2/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >HostAgent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/strategy/">Processing Strategy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/host_agent/commands/">Command System</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >AppAgent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/strategy/">Processing Strategy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/app_agent/commands/">Command System</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core Features</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/core_features/hybrid_actions/">Hybrid GUI–API Actions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Control Detection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/uia_detection/">UIA Detection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/visual_detection/">Visual Detection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/control_detection/hybrid_detection/">Hybrid Detection</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Knowledge Substrate</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/learning_from_help_document/">Help Documents</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/learning_from_bing_search/">Bing Search</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/experience_learning/">Experience Learning</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/core_features/knowledge_substrate/learning_from_demonstration/">Demos</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/core_features/multi_action/">Speculative Multi-Action</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Advanced Usage</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/follower_mode/">Follower Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/batch_mode/">Batch Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/operator_as_app_agent/">Operator Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/advanced_usage/customization/">Customization</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Prompts</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/prompts/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/prompts/basic_template/">Basic Template</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/prompts/examples_prompts/">Examples</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/evaluation_agent/">EvaluationAgent</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/benchmark/overview/">Benchmark Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/benchmark/windows_agent_arena/">Windows Agent Arena</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/evaluation/benchmark/osworld/">OSWorld (Windows)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Performance Logs</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/evaluation_logs/">Evaluation Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/markdown_log_viewer/">Markdown Log Viewer</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/request_logs/">Request Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/screenshots_logs/">Screenshots Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/step_logs/">Step Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../ufo2/evaluation/logs/ui_tree_logs/">UI Tree Logs</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Dataflow</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/instantiation/">Instantiation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/execution/">Execution</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/windows_app_env/">Windows App Environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ufo2/dataflow/result/">Result</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Linux Agent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/state/">State Machine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/strategy/">Processing Strategy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/commands/">MCP Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mobile Agent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/state/">State Machine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/strategy/">Processing Strategy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/commands/">MCP Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials & Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tutorials/creating_mcp_servers/">Creating Custom MCP Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tutorials/creating_third_party_agents/">Creating Custom Third-Party Agents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Creating Custom Device Agents</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/client_setup/">Client Setup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/core_components/">Core Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/mcp_server/">MCP Server</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/configuration/">Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/testing/">Testing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/example_mobile_agent/">Example Mobile Agent</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Enhancing AppAgent Capabilities</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/help_document_provision/">Help Document Provision</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/demonstration_provision/">Demonstration Provision</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/warpping_app_native_api/">Wrapping App-Native APIs</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Infrastructure</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >Basic Modules</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../overview/">Overview</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Session</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#relationship-session-vs-round">Relationship: Session vs Round</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#session-types">Session Types</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#class-hierarchy">Class Hierarchy</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#session-lifecycle">Session Lifecycle</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#standard-lifecycle">Standard Lifecycle</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#core-execution-loop">Core Execution Loop</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#lifecycle-stages">Lifecycle Stages</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#execution-modes">Execution Modes</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#normal-mode">Normal Mode</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#normal_operator-mode">Normal_Operator Mode</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#service-mode">Service Mode</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#follower-mode">Follower Mode</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#batch_normal-mode">Batch_Normal Mode</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#operator-mode">Operator Mode</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#platform-specific-sessions">Platform-Specific Sessions</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#windows-sessions">Windows Sessions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#linux-sessions">Linux Sessions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#experience-saving">Experience Saving</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#error-handling">Error Handling</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#error-states">Error States</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#error-recovery">Error Recovery</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#common-errors">Common Errors</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#best-practices">Best Practices</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#session-creation">Session Creation</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#interactive-sessions">Interactive Sessions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#service-sessions">Service Sessions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#batch-sessions">Batch Sessions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example-1-basic-interactive-session">Example 1: Basic Interactive Session</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#example-2-service-session">Example 2: Service Session</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#example-3-follower-session">Example 3: Follower Session</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#example-4-linux-session">Example 4: Linux Session</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#basesession">BaseSession</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession">BaseSession</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.application_window">application_window</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.application_window_info">application_window_info</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.context">context</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.cost">cost</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.current_agent_class">current_agent_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.current_round">current_round</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.evaluation_logger">evaluation_logger</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.host_agent">host_agent</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.id">id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.results">results</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.rounds">rounds</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.session_type">session_type</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.step">step</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.total_rounds">total_rounds</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.add_round">add_round</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.capture_last_screenshot">capture_last_screenshot</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.capture_last_snapshot">capture_last_snapshot</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.capture_last_ui_tree">capture_last_ui_tree</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.create_following_round">create_following_round</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.create_new_round">create_new_round</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.evaluation">evaluation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.experience_saver">experience_saver</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.initialize_logger">initialize_logger</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.is_error">is_error</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.is_finished">is_finished</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.next_request">next_request</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.print_cost">print_cost</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.request_to_evaluate">request_to_evaluate</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.reset">reset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.run">run</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.basic.BaseSession.save_log_to_markdown">save_log_to_markdown</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#session-windows">Session (Windows)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.session.Session">Session</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.session.Session.create_new_round">create_new_round</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.session.Session.next_request">next_request</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.session.Session.request_to_evaluate">request_to_evaluate</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.session.Session.run">run</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#linuxsession">LinuxSession</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.linux_session.LinuxSession">LinuxSession</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.linux_session.LinuxSession.create_new_round">create_new_round</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.linux_session.LinuxSession.next_request">next_request</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module.sessions.linux_session.LinuxSession.request_to_evaluate">request_to_evaluate</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#see-also">See Also</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../round/">Round</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../context/">Context</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../dispatcher/">Dispatcher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../session_pool/">Session Factory & Pool</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../platform_sessions/">Platform Sessions</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Device Agent Architecture</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/agent_types/">Agent Types & Implementation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../agents/server_client_architecture/">Server-Client Architecture</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Architecture Layers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/state/">State Layer (Level-1)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/processor/">Strategy Layer (Level-2)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/strategy/">Strategy Components</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/command/">Command Layer (Level-3)</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Supporting Systems</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/memory/">Memory System</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/blackboard/">Blackboard</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../agents/design/prompter/">Prompter</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Interaction Protocol (AIP)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/messages/">Message Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/protocols/">Protocol Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/transport/">Transport Layer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/endpoints/">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/resilience/">Resilience</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Server</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/session_manager/">Session Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/websocket_handler/">WebSocket Handler</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/client_connection_manager/">Client Connection Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/api/">HTTP API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/monitoring/">Monitoring</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Client</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/websocket_client/">WebSocket Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/ufo_client/">UFO Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/computer_manager/">Computer Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/computer/">Computer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/device_info/">Device Info Provider</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/mcp_integration/">MCP Integration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MCP (Model Context Protocol)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/data_collection/">Data Collection Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/action/">Action Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/configuration/">Configuration Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/local_servers/">Local Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/remote_servers/">Remote Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Server Reference</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/ui_collector/">UICollector</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/host_ui_executor/">HostUIExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/app_ui_executor/">AppUIExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/command_line_executor/">CommandLineExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/word_com_executor/">WordCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/excel_com_executor/">ExcelCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/ppt_com_executor/">PowerPointCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/pdf_reader_executor/">PDFReaderExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/constellation_editor/">ConstellationEditor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/hardware_executor/">HardwareExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/bash_executor/">BashExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/mobile_executor/">MobileExecutor</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/LICENSE/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CODE_OF_CONDUCT/">Code of Conduct</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/DISCLAIMER/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/SUPPORT/">Support</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../faq/">FAQ</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">UFO³ Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Infrastructure</li>
          <li class="breadcrumb-item">Basic Modules</li>
      <li class="breadcrumb-item active">Session</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="session">Session</h1>
<p>A <strong>Session</strong> is a continuous conversation instance between the user and UFO, managing multiple rounds of interaction from initial request to task completion across different execution modes and platforms.</p>
<p><strong>Quick Reference:</strong></p>
<ul>
<li>Session types? See <a href="#session-types">Session Types</a></li>
<li>Lifecycle? See <a href="#session-lifecycle">Session Lifecycle</a></li>
<li>Mode differences? See <a href="#execution-modes">Execution Modes</a></li>
<li>Platform differences? See <a href="#platform-specific-sessions">Platform-Specific Sessions</a></li>
</ul>
<hr />
<h2 id="overview">Overview</h2>
<p>A <code>Session</code> represents a complete conversation workflow, containing one or more <code>Rounds</code> of agent execution. Sessions manage:</p>
<ol>
<li><strong>Context</strong>: Shared state across all rounds</li>
<li><strong>Agents</strong>: HostAgent and AppAgent (or LinuxAgent)</li>
<li><strong>Rounds</strong>: Individual request-response cycles</li>
<li><strong>Evaluation</strong>: Optional task completion assessment</li>
<li><strong>Experience</strong>: Learning from successful workflows</li>
</ol>
<h3 id="relationship-session-vs-round">Relationship: Session vs Round</h3>
<div class="mermaid">graph TB
    subgraph "Session (Conversation)"
        S[Session Instance]
        CTX[Context&lt;br/&gt;Shared State]
        R1[Round 1&lt;br/&gt;Request 1]
        R2[Round 2&lt;br/&gt;Request 2]
        R3[Round 3&lt;br/&gt;Request 3]
        EVAL[Evaluation&lt;br/&gt;Optional]
    end

    subgraph "Round 1 Details"
        HOST1[HostAgent]
        APP1[AppAgent]
        CMD1[Commands]
    end

    subgraph "Round 2 Details"
        HOST2[HostAgent]
        APP2[AppAgent]
        CMD2[Commands]
    end

    S --&gt; CTX
    S --&gt; R1
    S --&gt; R2
    S --&gt; R3
    S --&gt; EVAL

    R1 -.shares.-&gt; CTX
    R2 -.shares.-&gt; CTX
    R3 -.shares.-&gt; CTX

    R1 --&gt; HOST1
    HOST1 --&gt; APP1
    APP1 --&gt; CMD1

    R2 --&gt; HOST2
    HOST2 --&gt; APP2
    APP2 --&gt; CMD2

    style S fill:#e1f5ff
    style CTX fill:#fff4e1
    style R1 fill:#f0ffe1
    style R2 fill:#f0ffe1
    style R3 fill:#f0ffe1
    style EVAL fill:#ffe1f5</div>
<hr />
<h2 id="session-types">Session Types</h2>
<p>UFO supports <strong>7 session types</strong> across Windows and Linux platforms:</p>
<table>
<thead>
<tr>
<th>Session Type</th>
<th>Platform</th>
<th>Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Session</strong></td>
<td>Windows</td>
<td><code>normal</code>, <code>normal_operator</code></td>
<td>Interactive with HostAgent</td>
</tr>
<tr>
<td><strong>ServiceSession</strong></td>
<td>Windows</td>
<td><code>service</code></td>
<td>WebSocket-controlled via AIP</td>
</tr>
<tr>
<td><strong>FollowerSession</strong></td>
<td>Windows</td>
<td><code>follower</code></td>
<td>Replays saved plans</td>
</tr>
<tr>
<td><strong>FromFileSession</strong></td>
<td>Windows</td>
<td><code>batch_normal</code></td>
<td>Executes from request files</td>
</tr>
<tr>
<td><strong>OpenAIOperatorSession</strong></td>
<td>Windows</td>
<td><code>operator</code></td>
<td>Pure operator mode</td>
</tr>
<tr>
<td><strong>LinuxSession</strong></td>
<td>Linux</td>
<td><code>normal</code>, <code>normal_operator</code></td>
<td>Interactive without HostAgent</td>
</tr>
<tr>
<td><strong>LinuxServiceSession</strong></td>
<td>Linux</td>
<td><code>service</code></td>
<td>WebSocket-controlled on Linux</td>
</tr>
</tbody>
</table>
<h3 id="class-hierarchy">Class Hierarchy</h3>
<div class="mermaid">graph TB
    BASE[BaseSession&lt;br/&gt;Abstract]

    WIN_BASE[WindowsBaseSession&lt;br/&gt;with HostAgent]
    LINUX_BASE[LinuxBaseSession&lt;br/&gt;without HostAgent]

    SESSION[Session&lt;br/&gt;Interactive]
    SERVICE[ServiceSession&lt;br/&gt;WebSocket]
    FOLLOWER[FollowerSession&lt;br/&gt;Plan Replay]
    FROMFILE[FromFileSession&lt;br/&gt;Batch]
    OPERATOR[OpenAIOperatorSession&lt;br/&gt;Operator]

    LINUX_SESS[LinuxSession&lt;br/&gt;Interactive]
    LINUX_SERVICE[LinuxServiceSession&lt;br/&gt;WebSocket]

    BASE --&gt; WIN_BASE
    BASE --&gt; LINUX_BASE

    WIN_BASE --&gt; SESSION
    WIN_BASE --&gt; SERVICE
    WIN_BASE --&gt; FOLLOWER
    WIN_BASE --&gt; FROMFILE
    WIN_BASE --&gt; OPERATOR

    LINUX_BASE --&gt; LINUX_SESS
    LINUX_BASE --&gt; LINUX_SERVICE

    style BASE fill:#e1f5ff
    style WIN_BASE fill:#fff4e1
    style LINUX_BASE fill:#f0ffe1
    style SESSION fill:#e1ffe1
    style LINUX_SESS fill:#e1ffe1</div>
<div class="admonition note">
<p class="admonition-title">Platform Base Classes</p>
<ul>
<li><code>WindowsBaseSession</code>: Creates HostAgent, supports two-tier architecture</li>
<li><code>LinuxBaseSession</code>: Single-tier architecture with LinuxAgent only</li>
</ul>
</div>
<hr />
<h2 id="session-lifecycle">Session Lifecycle</h2>
<h3 id="standard-lifecycle">Standard Lifecycle</h3>
<div class="mermaid">stateDiagram-v2
    [*] --&gt; Initialized: __init__
    Initialized --&gt; ContextReady: _init_context
    ContextReady --&gt; Running: run()

    Running --&gt; RoundCreate: create_new_round
    RoundCreate --&gt; RoundExecute: round.run()
    RoundExecute --&gt; RoundComplete: Round finishes

    RoundComplete --&gt; CheckMore: is_finished?
    CheckMore --&gt; RoundCreate: More requests
    CheckMore --&gt; Snapshot: No more requests

    Snapshot --&gt; Evaluation: capture_last_snapshot
    Evaluation --&gt; CostPrint: evaluation() if enabled
    CostPrint --&gt; [*]: Session complete</div>
<h3 id="core-execution-loop">Core Execution Loop</h3>
<p>The main session logic:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span><span class="p">():</span>
        <span class="c1"># Create new round for each request</span>
        <span class="nb">round</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_new_round</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">round</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c1"># Execute the round</span>
        <span class="k">await</span> <span class="nb">round</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="c1"># Capture final state</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_last_snapshot</span><span class="p">()</span>

    <span class="c1"># Evaluate if configured</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_evaluate</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_error</span><span class="p">():</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">()</span>

    <span class="c1"># Print cost summary</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">print_cost</span><span class="p">()</span>
</code></pre></div>
<h3 id="lifecycle-stages">Lifecycle Stages</h3>
<h4 id="1-initialization">1. Initialization</h4>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;email_task&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;Send an email to John&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>What happens:</strong>
- Task name assigned
- Session ID set
- Initial request stored
- Mode configured</p>
<h4 id="2-context-initialization">2. Context Initialization</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_init_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the session context.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_init_context</span><span class="p">()</span>

    <span class="c1"># Create MCP server manager</span>
    <span class="n">mcp_server_manager</span> <span class="o">=</span> <span class="n">MCPServerManager</span><span class="p">()</span>

    <span class="c1"># Create local dispatcher</span>
    <span class="n">command_dispatcher</span> <span class="o">=</span> <span class="n">LocalCommandDispatcher</span><span class="p">(</span>
        <span class="n">session</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">mcp_server_manager</span><span class="o">=</span><span class="n">mcp_server_manager</span>
    <span class="p">)</span>

    <span class="c1"># Attach to context</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">attach_command_dispatcher</span><span class="p">(</span><span class="n">command_dispatcher</span><span class="p">)</span>
</code></pre></div>
<p><strong>What happens:</strong>
- Context object created
- Command dispatcher attached (Local or WebSocket)
- MCP servers initialized (if applicable)
- Application window tracked</p>
<h4 id="3-round-creation">3. Round Creation</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_new_round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new round.&quot;&quot;&quot;</span>

    <span class="c1"># Get request (first or new)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">REQUEST</span><span class="p">):</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">first_request</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">complete</span> <span class="o">=</span> <span class="n">new_request</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">complete</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Create round with request</span>
    <span class="nb">round</span> <span class="o">=</span> <span class="n">Round</span><span class="p">(</span>
        <span class="n">task</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">,</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_num</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_round_num</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">round</span>
</code></pre></div>
<p><strong>What happens:</strong>
- User prompted for request (interactive modes)
- Or request read from file/plan (non-interactive)
- Round object created with shared context
- Round counter incremented</p>
<h4 id="4-round-execution">4. Round Execution</h4>
<div class="highlight"><pre><span></span><code><span class="k">await</span> <span class="nb">round</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>What happens:</strong>
- HostAgent selects application (Windows)
- AppAgent executes in application (or LinuxAgent directly)
- Commands dispatched and executed
- Results captured in context
- Experience logged</p>
<h4 id="5-continuation-check">5. Continuation Check</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if session is complete.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">SESSION_FINISH</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p><strong>What happens:</strong>
- Check if user wants another request
- Check if error occurred
- Check if plan is complete (follower/batch modes)</p>
<h4 id="6-final-snapshot">6. Final Snapshot</h4>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">capture_last_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Capture the last snapshot of the application.&quot;&quot;&quot;</span>

    <span class="n">last_round</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">ROUND_STEP</span><span class="p">)</span>
    <span class="n">subtask_amount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">SUBTASK_AMOUNT</span><span class="p">)</span>

    <span class="c1"># Capture screenshot</span>
    <span class="n">screenshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span><span class="o">.</span><span class="n">capture_screenshot_infor</span><span class="p">()</span>

    <span class="c1"># Save to logs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_writer</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">(</span>
        <span class="n">screenshot</span><span class="p">,</span>
        <span class="n">last_round</span><span class="p">,</span>
        <span class="n">subtask_amount</span><span class="p">,</span>
        <span class="s2">&quot;last&quot;</span>
    <span class="p">)</span>
</code></pre></div>
<p><strong>What happens:</strong>
- Screenshot captured
- Control tree logged
- Final state preserved</p>
<h4 id="7-evaluation">7. Evaluation</h4>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate the session.&quot;&quot;&quot;</span>

    <span class="n">evaluator</span> <span class="o">=</span> <span class="n">EvaluationAgent</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;evaluation&quot;</span><span class="p">,</span>
        <span class="n">process_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">APPLICATION_PROCESS_NAME</span><span class="p">),</span>
        <span class="n">app_root_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">APPLICATION_ROOT_NAME</span><span class="p">),</span>
        <span class="n">is_visual</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">[</span><span class="s2">&quot;EVA_SESSION&quot;</span><span class="p">][</span><span class="s2">&quot;VIS_EVAL&quot;</span><span class="p">],</span>
        <span class="n">main_prompt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">[</span><span class="s2">&quot;EVA_SESSION&quot;</span><span class="p">][</span><span class="s2">&quot;MAIN_PROMPT&quot;</span><span class="p">],</span>
        <span class="n">api_prompt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">[</span><span class="s2">&quot;EVA_SESSION&quot;</span><span class="p">][</span><span class="s2">&quot;API_PROMPT&quot;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
        <span class="n">request</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">REQUEST</span><span class="p">),</span>
        <span class="n">trajectory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">TRAJECTORY</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">file_writer</span><span class="o">.</span><span class="n">save_evaluation</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</code></pre></div>
<p><strong>What happens:</strong>
- EvaluationAgent created
- Task completion assessed
- Score logged
- Feedback saved</p>
<h4 id="8-cost-summary">8. Cost Summary</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the session cost.&quot;&quot;&quot;</span>

    <span class="n">total_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">TOTAL_COST</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">total_tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">TOTAL_TOKENS</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold green]Session Complete[/bold green]&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Cost: $</span><span class="si">{</span><span class="n">total_cost</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Tokens: </span><span class="si">{</span><span class="n">total_tokens</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="execution-modes">Execution Modes</h2>
<h3 id="normal-mode">Normal Mode</h3>
<p><strong>Interactive execution with user in the loop:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;document_edit&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Will prompt user</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>Features:</strong>
- User prompted for initial request via <code>first_request()</code>
- User prompted for each new request via <code>new_request()</code>
- Commands executed locally via <code>LocalCommandDispatcher</code>
- User can exit anytime by typing "N"</p>
<p><strong>Flow:</strong>
<div class="highlight"><pre><span></span><code>1. Display welcome panel
2. User enters: &quot;Open Word&quot;
3. HostAgent selects Word application
4. AppAgent types content
5. User asked: &quot;What next?&quot;
6. User enters: &quot;Save document&quot;
7. AppAgent saves file
8. User asked: &quot;What next?&quot;
9. User enters: &quot;N&quot; (exit)
10. Session ends
</code></pre></div></p>
<h3 id="normal_operator-mode">Normal_Operator Mode</h3>
<p><strong>Normal mode with operator capabilities:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;complex_workflow&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;Organize my files by date&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;normal_operator&quot;</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>Differences from Normal:</strong>
- Agent can use operator-level actions
- More powerful command set
- Same interactive workflow</p>
<h3 id="service-mode">Service Mode</h3>
<p><strong>WebSocket-controlled remote execution:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">aip.protocol.task_execution</span><span class="w"> </span><span class="kn">import</span> <span class="n">TaskExecutionProtocol</span>

<span class="n">protocol</span> <span class="o">=</span> <span class="n">TaskExecutionProtocol</span><span class="p">(</span><span class="n">websocket_connection</span><span class="p">)</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">ServiceSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;remote_automation&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;session_abc123&quot;</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;Click Submit button&quot;</span><span class="p">,</span>
    <span class="n">task_protocol</span><span class="o">=</span><span class="n">protocol</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>Features:</strong>
- No user interaction prompts
- Single request per session
- Commands sent via WebSocket
- Results returned to server
- Uses <code>WebSocketCommandDispatcher</code></p>
<p><strong>Flow:</strong>
<div class="highlight"><pre><span></span><code>1. Server sends request via WebSocket
2. ServiceSession created
3. Agent generates commands
4. Commands sent to client via WebSocket
5. Client executes locally
6. Results sent back
7. Session finishes immediately
</code></pre></div></p>
<p><strong>Key Difference:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Service session finishes after one round.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_num</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div>
<h3 id="follower-mode">Follower Mode</h3>
<p><strong>Replay saved action plans:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">FollowerSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;email_replay&quot;</span><span class="p">,</span>
    <span class="n">plan_file</span><span class="o">=</span><span class="s2">&quot;/plans/send_email.json&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>Features:</strong>
- No user prompts
- Reads actions from plan file
- Deterministic execution
- Good for testing/demos</p>
<p><strong>Plan File Format:</strong></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Send an email to John&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HostAgent&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;select_application&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;app_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Outlook&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AppAgent&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;click_element&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;New Email&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="batch_normal-mode">Batch_Normal Mode</h3>
<p><strong>Execute multiple requests from files:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">FromFileSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;batch_task&quot;</span><span class="p">,</span>
    <span class="n">plan_file</span><span class="o">=</span><span class="s2">&quot;/requests/task1.json&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>Features:</strong>
- Request loaded from file
- No user interaction
- Can batch multiple files with SessionPool
- Task status tracking available</p>
<p><strong>Request File:</strong></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Create a spreadsheet with sales data&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="operator-mode">Operator Mode</h3>
<p><strong>Pure operator-level execution:</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="n">OpenAIOperatorSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;system_automation&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;Install and configure software&quot;</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>Features:</strong>
- Operator-level permissions
- Can modify system settings
- More powerful than AppAgent
- Same interactive prompts as normal mode</p>
<hr />
<h2 id="platform-specific-sessions">Platform-Specific Sessions</h2>
<h3 id="windows-sessions">Windows Sessions</h3>
<p><strong>Characteristics:</strong>
- <strong>Two-tier architecture</strong>: HostAgent → AppAgent
- <strong>Base class</strong>: <code>WindowsBaseSession</code>
- <strong>Agent flow</strong>: HostAgent selects app, AppAgent controls it
- <strong>Automation</strong>: Uses UIA (UI Automation)</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Session</span><span class="p">(</span><span class="n">WindowsBaseSession</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Windows interactive session.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with HostAgent.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_init_context</span><span class="p">()</span>

        <span class="c1"># HostAgent created by WindowsBaseSession</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_host_agent</span><span class="p">()</span>

        <span class="c1"># MCP and LocalCommandDispatcher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_command_dispatcher</span><span class="p">()</span>
</code></pre></div>
<h3 id="linux-sessions">Linux Sessions</h3>
<p><strong>Characteristics:</strong>
- <strong>Single-tier architecture</strong>: LinuxAgent only (no HostAgent)
- <strong>Base class</strong>: <code>LinuxBaseSession</code>
- <strong>Agent flow</strong>: LinuxAgent controls application directly
- <strong>Automation</strong>: Platform-specific tools</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LinuxSession</span><span class="p">(</span><span class="n">LinuxBaseSession</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Linux interactive session.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize without HostAgent.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_init_context</span><span class="p">()</span>

        <span class="c1"># No HostAgent - direct LinuxAgent usage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linux_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_linux_agent</span><span class="p">(</span>
            <span class="n">application_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">application_name</span>
        <span class="p">)</span>
</code></pre></div>
<p><strong>Comparison:</strong></p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Windows</th>
<th>Linux</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Architecture</strong></td>
<td>Two-tier (HostAgent + AppAgent)</td>
<td>Single-tier (LinuxAgent)</td>
</tr>
<tr>
<td><strong>Application Selection</strong></td>
<td>HostAgent decides</td>
<td>Pre-specified or LinuxAgent decides</td>
</tr>
<tr>
<td><strong>Agent Switching</strong></td>
<td>Yes (HostAgent ↔ AppAgent)</td>
<td>No</td>
</tr>
<tr>
<td><strong>Modes Supported</strong></td>
<td>All 7 modes</td>
<td>normal, normal_operator, service</td>
</tr>
<tr>
<td><strong>UI Automation</strong></td>
<td>UIA (UIAutomation)</td>
<td>Platform tools</td>
</tr>
</tbody>
</table>
<p>See <a href="../platform_sessions/">Platform Sessions</a> for detailed comparison.</p>
<hr />
<h2 id="experience-saving">Experience Saving</h2>
<p>Sessions can save successful workflows for future learning:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># After successful task completion</span>
<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configs</span><span class="p">[</span><span class="s2">&quot;SAVE_EXPERIENCE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ask&quot;</span><span class="p">:</span>
    <span class="n">save</span> <span class="o">=</span> <span class="n">experience_asker</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_experience</span><span class="p">()</span>
</code></pre></div>
<p><strong>Save Modes:</strong></p>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>always</code></td>
<td>Auto-save every successful session</td>
</tr>
<tr>
<td><code>ask</code></td>
<td>Prompt user after each session</td>
</tr>
<tr>
<td><code>auto</code></td>
<td>Save if evaluation score &gt; threshold</td>
</tr>
<tr>
<td><code>always_not</code></td>
<td>Never save</td>
</tr>
</tbody>
</table>
<p><strong>Saved Experience Structure:</strong></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Send email&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Send an email to John about the meeting&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;trajectory&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;round&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HostAgent&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;observation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Desktop with Outlook icon&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;select_application&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;app_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Outlook&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;round&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AppAgent&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;observation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Outlook main window&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;click_element&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;New Email&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;outcome&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;evaluation_score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;cost&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0234</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;tokens&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1542</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="error-handling">Error Handling</h2>
<h3 id="error-states">Error States</h3>
<p>Sessions track errors through context:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_error</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if session encountered error.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set error state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ContextNames</span><span class="o">.</span><span class="n">ERROR_MESSAGE</span><span class="p">,</span> <span class="n">error_message</span><span class="p">)</span>
</code></pre></div>
<h3 id="error-recovery">Error Recovery</h3>
<div class="highlight"><pre><span></span><code><span class="k">try</span><span class="p">:</span>
    <span class="k">await</span> <span class="nb">round</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="k">except</span> <span class="n">AgentError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_num</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Decide whether to continue or abort</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_recover</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
        <span class="c1"># Try next round</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Abort session</span>
        <span class="k">break</span>
</code></pre></div>
<h3 id="common-errors">Common Errors</h3>
<table>
<thead>
<tr>
<th>Error Type</th>
<th>Cause</th>
<th>Handling</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TimeoutError</strong></td>
<td>Command execution timeout</td>
<td>Retry or skip</td>
</tr>
<tr>
<td><strong>ConnectionError</strong></td>
<td>WebSocket/MCP disconnection</td>
<td>Reconnect or abort</td>
</tr>
<tr>
<td><strong>AgentError</strong></td>
<td>Agent decision failure</td>
<td>Log and retry</td>
</tr>
<tr>
<td><strong>ValidationError</strong></td>
<td>Invalid command parameters</td>
<td>Skip command</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="best-practices">Best Practices</h2>
<h3 id="session-creation">Session Creation</h3>
<div class="admonition tip">
<p class="admonition-title">Efficient Sessions</p>
<ul>
<li>✅ Use <code>SessionFactory.create_session()</code> for platform-aware creation</li>
<li>✅ Enable evaluation for quality tracking</li>
<li>✅ Choose appropriate mode for use case</li>
<li>✅ Set meaningful task names for logging</li>
<li>❌ Don't create sessions directly (use factory)</li>
<li>❌ Don't mix modes (each session has one mode)</li>
</ul>
</div>
<h3 id="interactive-sessions">Interactive Sessions</h3>
<div class="admonition success">
<p class="admonition-title">User Experience</p>
<ul>
<li>✅ Provide clear initial requests</li>
<li>✅ Allow users to exit gracefully ("N" option)</li>
<li>✅ Show progress and confirmations</li>
<li>✅ Handle sensitive actions with confirmation</li>
<li>❌ Don't prompt excessively</li>
<li>❌ Don't hide errors from users</li>
</ul>
</div>
<h3 id="service-sessions">Service Sessions</h3>
<div class="admonition warning">
<p class="admonition-title">WebSocket Considerations</p>
<ul>
<li>✅ Always provide <code>task_protocol</code></li>
<li>✅ Handle connection loss gracefully</li>
<li>✅ Set appropriate timeouts</li>
<li>✅ Validate requests before execution</li>
<li>❌ Don't assume connection is stable</li>
<li>❌ Don't block waiting for results indefinitely</li>
</ul>
</div>
<h3 id="batch-sessions">Batch Sessions</h3>
<div class="admonition tip">
<p class="admonition-title">Batch Processing</p>
<ul>
<li>✅ Enable task status tracking</li>
<li>✅ Use descriptive file names</li>
<li>✅ Group similar tasks</li>
<li>✅ Log failures for retry</li>
<li>❌ Don't stop batch on first failure</li>
<li>❌ Don't run too many sessions in parallel</li>
</ul>
</div>
<hr />
<h2 id="examples">Examples</h2>
<h3 id="example-1-basic-interactive-session">Example 1: Basic Interactive Session</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">ufo.module.sessions.session</span><span class="w"> </span><span class="kn">import</span> <span class="n">Session</span>

<span class="c1"># Create session</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;word_editing&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Will prompt user</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span>
<span class="p">)</span>

<span class="c1"># Run session</span>
<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># User interaction:</span>
<span class="c1"># 1. Welcome panel shown</span>
<span class="c1"># 2. User enters: &quot;Open Word and type Hello World&quot;</span>
<span class="c1"># 3. HostAgent selects Word</span>
<span class="c1"># 4. AppAgent types text</span>
<span class="c1"># 5. User asked for next request</span>
<span class="c1"># 6. User enters: &quot;N&quot; to exit</span>
<span class="c1"># 7. Session evaluates and ends</span>
</code></pre></div>
<h3 id="example-2-service-session">Example 2: Service Session</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">ufo.module.sessions.service_session</span><span class="w"> </span><span class="kn">import</span> <span class="n">ServiceSession</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">aip.protocol.task_execution</span><span class="w"> </span><span class="kn">import</span> <span class="n">TaskExecutionProtocol</span>

<span class="c1"># WebSocket established</span>
<span class="n">protocol</span> <span class="o">=</span> <span class="n">TaskExecutionProtocol</span><span class="p">(</span><span class="n">websocket</span><span class="p">)</span>

<span class="c1"># Create service session</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">ServiceSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;remote_click&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Server evaluates</span>
    <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;sess_12345&quot;</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;Click the Submit button&quot;</span><span class="p">,</span>
    <span class="n">task_protocol</span><span class="o">=</span><span class="n">protocol</span>
<span class="p">)</span>

<span class="c1"># Run (non-blocking for client)</span>
<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Session finishes after one request</span>
</code></pre></div>
<h3 id="example-3-follower-session">Example 3: Follower Session</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">ufo.module.sessions.session</span><span class="w"> </span><span class="kn">import</span> <span class="n">FollowerSession</span>

<span class="c1"># Replay saved plan</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">FollowerSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;email_demo&quot;</span><span class="p">,</span>
    <span class="n">plan_file</span><span class="o">=</span><span class="s2">&quot;./plans/send_email.json&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Executes exactly as recorded in plan file</span>
<span class="c1"># No user prompts</span>
<span class="c1"># Deterministic execution</span>
</code></pre></div>
<h3 id="example-4-linux-session">Example 4: Linux Session</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">ufo.module.sessions.linux_session</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinuxSession</span>

<span class="c1"># Linux interactive session</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">LinuxSession</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;linux_task&quot;</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">request</span><span class="o">=</span><span class="s2">&quot;Open gedit and type Hello Linux&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="n">application_name</span><span class="o">=</span><span class="s2">&quot;gedit&quot;</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Single-tier architecture</span>
<span class="c1"># No HostAgent</span>
<span class="c1"># LinuxAgent controls gedit directly</span>
</code></pre></div>
<hr />
<h2 id="reference">Reference</h2>
<h3 id="basesession">BaseSession</h3>


<div class="doc doc-object doc-class">



<a id="module.basic.BaseSession"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>A basic session in UFO. A session consists of multiple rounds of interactions and conversations.</p>

        <p>Initialize a session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>task</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of current task.</p>
              </div>
            </li>
            <li>
              <b><code>should_evaluate</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>Whether to evaluate the session.</p>
              </div>
            </li>
            <li>
              <b><code>id</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The id of the session.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>module/basic.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">should_evaluate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a session.</span>
<span class="sd">    :param task: The name of current task.</span>
<span class="sd">    :param should_evaluate: Whether to evaluate the session.</span>
<span class="sd">    :param id: The id of the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_should_evaluate</span> <span class="o">=</span> <span class="n">should_evaluate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="nb">id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>

    <span class="c1"># Logging-related properties</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;logs/</span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">/&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">create_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rounds</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">BaseRound</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_context</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_finish</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="c1"># Initialize platform-specific agents</span>
    <span class="c1"># Subclasses should override _init_agents() to set up their agents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_host_agent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">HostAgent</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_agents</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.application_window" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">application_window</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the application of the session.
return: The application of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.application_window_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">application_window_info</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the application window info of the session.
return: The application window info of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">context</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the context of the session.
return: The context of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.cost" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cost</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the cost of the session.
return: The cost of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.current_agent_class" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">current_agent_class</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the class name of the current agent.
return: The class name of the current agent.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.current_round" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">current_round</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the current round of the session.
return: The current round of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.evaluation_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluation_logger</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the file writer for evaluation.
return: The file writer for evaluation.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.host_agent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">host_agent</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the host agent of the session.
May return None for sessions that don't use a host agent (e.g., Linux).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[<span title="ufo.agents.agent.host_agent.HostAgent">HostAgent</span>]</code>
              –
              <div class="doc-md-description">
                <p>The host agent of the session, or None if not applicable.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.id" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">id</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the id of the session.
return: The id of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">results</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the evaluation results of the session.
return: The evaluation results of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.rounds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rounds</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the rounds of the session.
return: The rounds of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.session_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">session_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the class name of the session.
return: The class name of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the step of the session.
return: The step of the session.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="module.basic.BaseSession.total_rounds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_rounds</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the total number of rounds in the session.
return: The total number of rounds in the session.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.add_round" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_round</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="nb">round</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Add a round to the session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>id</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The id of the round.</p>
              </div>
            </li>
            <li>
              <b><code>round</code></b>
                  (<code><a class="autorefs autorefs-internal" title="module.basic.BaseRound" href="../round/#module.basic.BaseRound">BaseRound</a></code>)
              –
              <div class="doc-md-description">
                <p>The round to be added.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="n">BaseRound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a round to the session.</span>
<span class="sd">    :param id: The id of the round.</span>
<span class="sd">    :param round: The round to be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rounds</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.capture_last_screenshot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">capture_last_screenshot</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="n">full_screen</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Capture the last window screenshot.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>save_path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The path to save the window screenshot.</p>
              </div>
            </li>
            <li>
              <b><code>full_screen</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to capture the full screen or just the active window.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">capture_last_screenshot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">full_screen</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Capture the last window screenshot.</span>
<span class="sd">    :param save_path: The path to save the window screenshot.</span>
<span class="sd">    :param full_screen: Whether to capture the full screen or just the active window.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">full_screen</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="o">=</span><span class="s2">&quot;capture_desktop_screenshot&quot;</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;all_screens&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                <span class="n">tool_type</span><span class="o">=</span><span class="s2">&quot;data_collection&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="n">command</span> <span class="o">=</span> <span class="n">Command</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="o">=</span><span class="s2">&quot;capture_window_screenshot&quot;</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">tool_type</span><span class="o">=</span><span class="s2">&quot;data_collection&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">command_dispatcher</span><span class="o">.</span><span class="n">execute_commands</span><span class="p">([</span><span class="n">command</span><span class="p">])</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Captured screenshot at final: </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">save_image_string</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The last snapshot capture failed, due to the error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.capture_last_snapshot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">capture_last_snapshot</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Capture the last snapshot of the application, including the screenshot and the XML file if configured.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">capture_last_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Capture the last snapshot of the application, including the screenshot and the XML file if configured.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># Capture the final screenshot</span>
    <span class="n">screenshot_save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_path</span> <span class="o">+</span> <span class="s2">&quot;action_step_final.png&quot;</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">application_window</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">application_window_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">):</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_last_screenshot</span><span class="p">(</span><span class="n">screenshot_save_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">save_ui_tree</span><span class="p">:</span>
            <span class="n">ui_tree_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span><span class="p">,</span> <span class="s2">&quot;ui_trees&quot;</span><span class="p">)</span>
            <span class="n">ui_tree_file_name</span> <span class="o">=</span> <span class="s2">&quot;ui_tree_final.json&quot;</span>
            <span class="n">ui_tree_save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ui_tree_path</span><span class="p">,</span> <span class="n">ui_tree_file_name</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_last_ui_tree</span><span class="p">(</span><span class="n">ui_tree_save_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">save_full_screen</span><span class="p">:</span>

            <span class="n">desktop_save_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_path</span> <span class="o">+</span> <span class="s2">&quot;desktop_final.png&quot;</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_last_screenshot</span><span class="p">(</span><span class="n">desktop_save_path</span><span class="p">,</span> <span class="n">full_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.capture_last_ui_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">capture_last_ui_tree</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Capture the last UI tree snapshot.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>save_path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The path to save the UI tree snapshot.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">capture_last_ui_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Capture the last UI tree snapshot.</span>
<span class="sd">    :param save_path: The path to save the UI tree snapshot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">command_dispatcher</span><span class="o">.</span><span class="n">execute_commands</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">Command</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="o">=</span><span class="s2">&quot;get_ui_tree&quot;</span><span class="p">,</span>
                <span class="n">parameters</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">tool_type</span><span class="o">=</span><span class="s2">&quot;data_collection&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.create_following_round" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_following_round</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a following round.
return: The following round.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_following_round</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseRound</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a following round.</span>
<span class="sd">    return: The following round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.create_new_round" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_new_round</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new round.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_new_round</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseRound</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new round.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.evaluation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluation</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Evaluate the session.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;📊 Evaluating the session...&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

    <span class="n">is_visual</span> <span class="o">=</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">evaluation_agent</span><span class="o">.</span><span class="n">visual_mode</span>

    <span class="n">evaluator</span> <span class="o">=</span> <span class="n">EvaluationAgent</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;eva_agent&quot;</span><span class="p">,</span>
        <span class="n">is_visual</span><span class="o">=</span><span class="n">is_visual</span><span class="p">,</span>
        <span class="n">main_prompt</span><span class="o">=</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">EVALUATION_PROMPT</span><span class="p">,</span>
        <span class="n">example_prompt</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">requests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_to_evaluate</span><span class="p">()</span>

    <span class="c1"># Evaluate the session, first use the default setting, if failed, then disable the screenshot evaluation.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
            <span class="n">request</span><span class="o">=</span><span class="n">requests</span><span class="p">,</span>
            <span class="n">log_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span><span class="p">,</span>
            <span class="n">eva_all_screenshots</span><span class="o">=</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">eva_all_screenshots</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
            <span class="n">request</span><span class="o">=</span><span class="n">requests</span><span class="p">,</span>
            <span class="n">log_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span><span class="p">,</span>
            <span class="n">eva_all_screenshots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Add additional information to the evaluation result.</span>
    <span class="n">additional_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;session&quot;</span><span class="p">,</span>
        <span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="n">requests</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;evaluation_result&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_info</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">+=</span> <span class="n">cost</span>

    <span class="n">evaluator</span><span class="o">.</span><span class="n">print_response</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_logger</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Evaluation result saved to </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;evaluation.log&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.experience_saver" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">experience_saver</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save the current trajectory as agent experience.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">experience_saver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the current trajectory as agent experience.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
        <span class="s2">&quot;📚 Summarizing and saving the execution flow as experience...&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">summarizer</span> <span class="o">=</span> <span class="n">ExperienceSummarizer</span><span class="p">(</span>
        <span class="n">ufo_config</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">visual_mode</span><span class="p">,</span>
        <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">EXPERIENCE_PROMPT</span><span class="p">,</span>
        <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">APPAGENT_EXAMPLE_PROMPT</span><span class="p">,</span>
        <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">API_PROMPT</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">experience</span> <span class="o">=</span> <span class="n">summarizer</span><span class="o">.</span><span class="n">read_logs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_path</span><span class="p">)</span>
    <span class="n">summaries</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">summarizer</span><span class="o">.</span><span class="n">get_summary_list</span><span class="p">(</span><span class="n">experience</span><span class="p">)</span>

    <span class="n">experience_path</span> <span class="o">=</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">EXPERIENCE_SAVED_PATH</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">create_folder</span><span class="p">(</span><span class="n">experience_path</span><span class="p">)</span>
    <span class="n">summarizer</span><span class="o">.</span><span class="n">create_or_update_yaml</span><span class="p">(</span>
        <span class="n">summaries</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">experience_path</span><span class="p">,</span> <span class="s2">&quot;experience.yaml&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">summarizer</span><span class="o">.</span><span class="n">create_or_update_vector_db</span><span class="p">(</span>
        <span class="n">summaries</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">experience_path</span><span class="p">,</span> <span class="s2">&quot;experience_db&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">+=</span> <span class="n">cost</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The experience has been saved to </span><span class="si">{</span><span class="n">experience_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.initialize_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_logger</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="n">log_filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Initialize logging.
log_path: The path of the log file.
log_filename: The name of the log file.
return: The logger.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">initialize_logger</span><span class="p">(</span><span class="n">log_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">log_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize logging.</span>
<span class="sd">    log_path: The path of the log file.</span>
<span class="sd">    log_filename: The name of the log file.</span>
<span class="sd">    return: The logger.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Code for initializing logging</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="n">log_filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">print_log</span><span class="p">:</span>
        <span class="c1"># Remove existing handlers if PRINT_LOG is False</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">log_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="n">log_filename</span><span class="p">)</span>
    <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logger</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.is_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_error</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check if the session is in error state.
return: True if the session is in error state, otherwise False.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the session is in error state.</span>
<span class="sd">    return: True if the session is in error state, otherwise False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_round</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_round</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="o">==</span> <span class="n">AgentStatus</span><span class="o">.</span><span class="n">ERROR</span><span class="o">.</span><span class="n">value</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.is_finished" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_finished</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check if the session is ended.
return: True if the session is ended, otherwise False.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the session is ended.</span>
<span class="sd">    return: True if the session is ended, otherwise False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finish</span>
        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">&gt;=</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">max_step</span>
        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span> <span class="o">&gt;=</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">max_round</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_error</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.next_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">next_request</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the next request of the session.
return: The request of the session.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">next_request</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the next request of the session.</span>
<span class="sd">    return: The request of the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.print_cost" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_cost</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Print the total cost of the session.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print the total cost of the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">formatted_cost</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;💰 Total request cost of the session: </span><span class="si">{</span><span class="n">formatted_cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;ℹ️  Cost is not available for the model </span><span class="si">{</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">host_agent</span><span class="o">.</span><span class="n">api_model</span><span class="si">}</span><span class="s2"> or </span><span class="si">{</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">app_agent</span><span class="o">.</span><span class="n">api_model</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cost information is not available.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.request_to_evaluate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">request_to_evaluate</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the request to evaluate.
return: The request(s) to evaluate.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">request_to_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the request to evaluate.</span>
<span class="sd">    return: The request(s) to evaluate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Reset the session to initial state.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reset the session to initial state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Run the session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
              –
              <div class="doc-md-description">
                <p>The result per session</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the session.</span>
<span class="sd">    :return: The result per session</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span><span class="p">():</span>

        <span class="nb">round</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_new_round</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">round</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">round_result</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">round</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;request&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">round_result</span><span class="p">})</span>

    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_last_snapshot</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_evaluate</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_error</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">log_to_markdown</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_log_to_markdown</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">print_cost</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.basic.BaseSession.save_log_to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_log_to_markdown</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Save the log of the session to markdown file.</p>


            <details class="quote">
              <summary>Source code in <code>module/basic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_log_to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the log of the session to markdown file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_path</span>
    <span class="n">trajectory</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">trajectory</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;/output.md&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trajectory saved to </span><span class="si">{</span><span class="n">file_path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/output.md&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="session-windows">Session (Windows)</h3>


<div class="doc doc-object doc-class">



<a id="module.sessions.session.Session"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ufo.module.sessions.platform_session.WindowsBaseSession">WindowsBaseSession</span></code></p>


        <p>A session for UFO.</p>

        <p>Initialize a session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>task</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of current task.</p>
              </div>
            </li>
            <li>
              <b><code>should_evaluate</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>Whether to evaluate the session.</p>
              </div>
            </li>
            <li>
              <b><code>id</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The id of the session.</p>
              </div>
            </li>
            <li>
              <b><code>request</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>The user request of the session, optional. If not provided, UFO will ask the user to input the request.</p>
              </div>
            </li>
            <li>
              <b><code>mode</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;normal&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>The mode of the task.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>module/sessions/session.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">request</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a session.</span>
<span class="sd">    :param task: The name of current task.</span>
<span class="sd">    :param should_evaluate: Whether to evaluate the session.</span>
<span class="sd">    :param id: The id of the session.</span>
<span class="sd">    :param request: The user request of the session, optional. If not provided, UFO will ask the user to input the request.</span>
<span class="sd">    :param mode: The mode of the task.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">should_evaluate</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span> <span class="o">=</span> <span class="n">request</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="module.sessions.session.Session.create_new_round" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_new_round</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new round.</p>


            <details class="quote">
              <summary>Source code in <code>module/sessions/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_new_round</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseRound</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new round.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get a request for the new round.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_request</span><span class="p">()</span>

    <span class="c1"># Create a new round and return None if the session is finished.</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_host_agent</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_host_agent</span><span class="o">.</span><span class="n">default_state</span><span class="p">)</span>

    <span class="nb">round</span> <span class="o">=</span> <span class="n">BaseRound</span><span class="p">(</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_host_agent</span><span class="p">,</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
        <span class="n">should_evaluate</span><span class="o">=</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">eva_round</span><span class="p">,</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_round</span><span class="p">(</span><span class="nb">round</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">round</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">round</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.sessions.session.Session.next_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">next_request</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the request for the host agent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="str">str</span></code>
              –
              <div class="doc-md-description">
                <p>The request for the host agent.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/sessions/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">next_request</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the request for the host agent.</span>
<span class="sd">    :return: The request for the host agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1"># If the request is provided via command line, use it directly.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span>
        <span class="c1"># Otherwise, ask the user to input the request with enhanced UX.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">interactor</span><span class="o">.</span><span class="n">first_request</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">iscomplete</span> <span class="o">=</span> <span class="n">interactor</span><span class="o">.</span><span class="n">new_request</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">iscomplete</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finish</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">request</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.sessions.session.Session.request_to_evaluate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">request_to_evaluate</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the request to evaluate.
return: The request(s) to evaluate.</p>


            <details class="quote">
              <summary>Source code in <code>module/sessions/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_to_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the request to evaluate.</span>
<span class="sd">    return: The request(s) to evaluate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host_agent</span><span class="o">.</span><span class="n">blackboard</span><span class="o">.</span><span class="n">requests</span>
    <span class="k">return</span> <span class="n">request_memory</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.sessions.session.Session.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Run the session.</p>


            <details class="quote">
              <summary>Source code in <code>module/sessions/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the session.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="c1"># Save the experience if the user asks so.</span>

    <span class="n">save_experience</span> <span class="o">=</span> <span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">save_experience</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Save experience setting: </span><span class="si">{</span><span class="n">save_experience</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_experience</span> <span class="o">==</span> <span class="s2">&quot;always&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experience_saver</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">save_experience</span> <span class="o">==</span> <span class="s2">&quot;ask&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">interactor</span><span class="o">.</span><span class="n">experience_asker</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experience_saver</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">save_experience</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
        <span class="n">task_completed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">task_completed</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experience_saver</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">save_experience</span> <span class="o">==</span> <span class="s2">&quot;always_not&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="linuxsession">LinuxSession</h3>


<div class="doc doc-object doc-class">



<a id="module.sessions.linux_session.LinuxSession"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ufo.module.sessions.platform_session.LinuxBaseSession">LinuxBaseSession</span></code></p>


        <p>A session for UFO on Linux platform.
Unlike Windows sessions, Linux sessions don't use a HostAgent.
They work directly with application agents.</p>

        <p>Initialize a Linux session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>task</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The name of current task.</p>
              </div>
            </li>
            <li>
              <b><code>should_evaluate</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>Whether to evaluate the session.</p>
              </div>
            </li>
            <li>
              <b><code>id</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The id of the session.</p>
              </div>
            </li>
            <li>
              <b><code>request</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>The user request of the session.</p>
              </div>
            </li>
            <li>
              <b><code>mode</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;normal&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>The mode of the task.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>module/sessions/linux_session.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">should_evaluate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">request</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a Linux session.</span>
<span class="sd">    :param task: The name of current task.</span>
<span class="sd">    :param should_evaluate: Whether to evaluate the session.</span>
<span class="sd">    :param id: The id of the session.</span>
<span class="sd">    :param request: The user request of the session.</span>
<span class="sd">    :param mode: The mode of the task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span> <span class="o">=</span> <span class="n">request</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">should_evaluate</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="module.sessions.linux_session.LinuxSession.create_new_round" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_new_round</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a new round for Linux session.
Since there's no host agent, directly create app-level rounds.</p>


            <details class="quote">
              <summary>Source code in <code>module/sessions/linux_session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_new_round</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseRound</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new round for Linux session.</span>
<span class="sd">    Since there&#39;s no host agent, directly create app-level rounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_request</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nb">round</span> <span class="o">=</span> <span class="n">BaseRound</span><span class="p">(</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent</span><span class="p">,</span>
        <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
        <span class="n">should_evaluate</span><span class="o">=</span><span class="n">ufo_config</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">eva_round</span><span class="p">,</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_round</span><span class="p">(</span><span class="nb">round</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">round</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.sessions.linux_session.LinuxSession.next_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">next_request</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the request for the app agent.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="str">str</span></code>
              –
              <div class="doc-md-description">
                <p>The request for the app agent.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/sessions/linux_session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">next_request</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the request for the app agent.</span>
<span class="sd">    :return: The request for the app agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">interactor</span><span class="o">.</span><span class="n">first_request</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">request</span><span class="p">,</span> <span class="n">iscomplete</span> <span class="o">=</span> <span class="n">interactor</span><span class="o">.</span><span class="n">new_request</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">iscomplete</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finish</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">request</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="module.sessions.linux_session.LinuxSession.request_to_evaluate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">request_to_evaluate</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the request to evaluate.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="str">str</span></code>
              –
              <div class="doc-md-description">
                <p>The request(s) to evaluate.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>module/sessions/linux_session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_to_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the request to evaluate.</span>
<span class="sd">    :return: The request(s) to evaluate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For Linux session, collect requests from all rounds</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_round</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_round</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span> <span class="s2">&quot;blackboard&quot;</span><span class="p">):</span>
        <span class="n">request_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_round</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">blackboard</span><span class="o">.</span><span class="n">requests</span>
        <span class="k">return</span> <span class="n">request_memory</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_request</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../round/">Round</a> - Individual request-response cycles</li>
<li><a href="../context/">Context</a> - Shared state management</li>
<li><a href="../session_pool/">Session Factory</a> - Session creation</li>
<li><a href="../platform_sessions/">Platform Sessions</a> - Windows vs Linux</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../overview/" class="btn btn-neutral float-left" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../round/" class="btn btn-neutral float-right" title="Round">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../overview/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../round/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      <script src="../../../javascripts/mermaid-init.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
