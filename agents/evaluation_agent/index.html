<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>EvaluationAgent - UFO Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "EvaluationAgent";
        var mkdocs_page_input_path = "agents/evaluation_agent.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> UFO Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../project_directory_structure/">Project Directory Structure</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/more_guidance/">More Guidance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Basic Modules</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/session/">Session</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/round/">Round</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../modules/context/">Context</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configurations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/user_configuration/">User Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/developer_configuration/">Developer Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configurations/pricing_configuration/">Model Pricing</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Supported Models</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/openai/">OpenAI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/azure_openai/">Azure OpenAI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/operator/">OpenAI CUA (Operator)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/gemini/">Gemini</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/claude/">Claude</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/qwen/">Qwen</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/deepseek/">DeepSeek</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/ollama/">Ollama</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../supported_models/custom_model/">Custom Model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agents</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Agent Design</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../design/memory/">Memory</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../design/blackboard/">Blackboard</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../design/state/">State</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../design/prompter/">Prompter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../design/processor/">Processor</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../host_agent/">HostAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../app_agent/">AppAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../follower_agent/">FollowerAgent</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">EvaluationAgent</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#evaluation-inputs">Evaluation Inputs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#evaluation-outputs">Evaluation Outputs</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Prompts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/basic_template/">Basic Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/examples_prompts/">Examples Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../prompts/api_prompts/">API Prompts</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Puppeteer</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/ui_automator/">GUI Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/wincom_automator/">API Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/web_automator/">Web Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/bash_automator/">Bash Automator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../automator/ai_tool_automator/">AI Tool</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Logs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/markdown_log_viewer/">Markdown Log Viewer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/request_logs/">Request Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/step_logs/">Step Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/evaluation_logs/">Evaluation Logs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/screenshots_logs/">Screenshots</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../logs/ui_tree_logs/">UI Tree</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Continuous Knowledge Substrate</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_help_document/">Learning from Help Document</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_bing_search/">Learning from Bing Search</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/experience_learning/">Experience Learning</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/reinforce_appagent/learning_from_demonstration/">Learning from User Demonstration</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/follower_mode/">Follower Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/batch_mode/">Batch Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/multi_action/">Speculative Multi-Action Execution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/operator_as_app_agent/">Operator-as-a-AppAgent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Control Filtering</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/text_filtering/">Text Filtering</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/semantic_filtering/">Semantic Filtering</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_filtering/icon_filtering/">Icon Filtering</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Control Detection</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/uia_detection/">UIA Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/visual_detection/">Visual Detection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/control_detection/hybrid_detection/">Hybrid Detection</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced_usage/customization/">Customization</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Creating Your AppAgent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/help_document_provision/">Help Document Provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/demonstration_provision/">Demonstration Provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../creating_app_agent/warpping_app_native_api/">Warpping App-Native API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Benchmark</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/windows_agent_arena/">Windows Agent Arena</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../benchmark/osworld/">OSWorld (Windows)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Dataflow</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/instantiation/">Instantiation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/execution/">Execution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/windows_app_env/">Windows App Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dataflow/result/">Result</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/LICENSE/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/CODE_OF_CONDUCT/">Code of Conduct</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/DISCLAIMER/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/SUPPORT/">Support</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">UFO Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Agents</li>
      <li class="breadcrumb-item active">EvaluationAgent</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="evaluationagent">EvaluationAgent 🧐</h1>
<p>The objective of the <code>EvaluationAgent</code> is to evaluate whether a <code>Session</code> or <code>Round</code> has been successfully completed. The <code>EvaluationAgent</code> assesses the performance of the <code>HostAgent</code> and <code>AppAgent</code> in fulfilling the request. You can configure whether to enable the <code>EvaluationAgent</code> in the <code>config_dev.yaml</code> file and the detailed documentation can be found <a href="../../configurations/developer_configuration/">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>EvaluationAgent</code> is fully LLM-driven and conducts evaluations based on the action trajectories and screenshots. It may not by 100% accurate since LLM may make mistakes.</p>
</div>
<p>We illustrate the evaluation process in the following figure:</p>
<h1 align="center">
    <img src="../../img/evaluator.png " alt="Evaluation Agent Image" width="60%">
</h1>

<h2 id="configuration">Configuration</h2>
<p>To enable the <code>EvaluationAgent</code>, you can configure the following parameters in the <code>config_dev.yaml</code> file to evaluate the task completion status at different levels:</p>
<table>
<thead>
<tr>
<th>Configuration Option</th>
<th>Description</th>
<th>Type</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>EVA_SESSION</code></td>
<td>Whether to include the session in the evaluation.</td>
<td>Boolean</td>
<td>True</td>
</tr>
<tr>
<td><code>EVA_ROUND</code></td>
<td>Whether to include the round in the evaluation.</td>
<td>Boolean</td>
<td>False</td>
</tr>
<tr>
<td><code>EVA_ALL_SCREENSHOTS</code></td>
<td>Whether to include all the screenshots in the evaluation.</td>
<td>Boolean</td>
<td>True</td>
</tr>
</tbody>
</table>
<h2 id="evaluation-inputs">Evaluation Inputs</h2>
<p>The <code>EvaluationAgent</code> takes the following inputs for evaluation:</p>
<table>
<thead>
<tr>
<th>Input</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>User Request</td>
<td>The user's request to be evaluated.</td>
<td>String</td>
</tr>
<tr>
<td>APIs Description</td>
<td>The description of the APIs used in the execution.</td>
<td>List of Strings</td>
</tr>
<tr>
<td>Action Trajectories</td>
<td>The action trajectories executed by the <code>HostAgent</code> and <code>AppAgent</code>.</td>
<td>List of Strings</td>
</tr>
<tr>
<td>Screenshots</td>
<td>The screenshots captured during the execution.</td>
<td>List of Images</td>
</tr>
</tbody>
</table>
<p>For more details on how to construct the inputs, please refer to the <code>EvaluationAgentPrompter</code> class in <code>ufo/prompter/eva_prompter.py</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can configure whether to use all screenshots or only the first and last screenshot for evaluation in the <code>EVA_ALL_SCREENSHOTS</code> of the <code>config_dev.yaml</code> file.</p>
</div>
<h2 id="evaluation-outputs">Evaluation Outputs</h2>
<p>The <code>EvaluationAgent</code> generates the following outputs after evaluation:</p>
<table>
<thead>
<tr>
<th>Output</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>reason</td>
<td>The detailed reason for your judgment, by observing the screenshot differences and the <Execution Trajectory>.</td>
<td>String</td>
</tr>
<tr>
<td>sub_scores</td>
<td>The sub-score of the evaluation in decomposing the evaluation into multiple sub-goals.</td>
<td>List of Dictionaries</td>
</tr>
<tr>
<td>complete</td>
<td>The completion status of the evaluation, can be <code>yes</code>, <code>no</code>, or <code>unsure</code>.</td>
<td>String</td>
</tr>
</tbody>
</table>
<p>Below is an example of the evaluation output:</p>
<pre><code class="language-json">{
    &quot;reason&quot;: &quot;The agent successfully completed the task of sending 'hello' to Zac on Microsoft Teams. 
    The initial screenshot shows the Microsoft Teams application with the chat window of Chaoyun Zhang open. 
    The agent then focused on the chat window, input the message 'hello', and clicked the Send button. 
    The final screenshot confirms that the message 'hello' was sent to Zac.&quot;, 
    &quot;sub_scores&quot;: {
        &quot;correct application focus&quot;: &quot;yes&quot;, 
        &quot;correct message input&quot;: &quot;yes&quot;, 
        &quot;message sent successfully&quot;: &quot;yes&quot;
        }, 
    &quot;complete&quot;: &quot;yes&quot;}
</code></pre>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The log of the evaluation results will be saved in the <code>logs/{task_name}/evaluation.log</code> file.</p>
</div>
<p>The <code>EvaluationAgent</code> employs the CoT mechanism to first decompose the evaluation into multiple sub-goals and then evaluate each sub-goal separately. The sub-scores are then aggregated to determine the overall completion status of the evaluation.</p>
<h1 id="reference">Reference</h1>


<div class="doc doc-object doc-class">



<a id="agents.agent.evaluation_agent.EvaluationAgent"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ufo.agents.agent.basic.BasicAgent">BasicAgent</span></code></p>


        <p>The agent for evaluation.</p>

        <p>Initialize the FollowAgent.
:agent_type: The type of the agent.
:is_visual: The flag indicating whether the agent is visual or not.</p>







                  <details class="quote">
                    <summary>Source code in <code>agents/agent/evaluation_agent.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_root_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">is_visual</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">main_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">example_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the FollowAgent.</span>
<span class="sd">    :agent_type: The type of the agent.</span>
<span class="sd">    :is_visual: The flag indicating whether the agent is visual or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_app_root_name</span> <span class="o">=</span> <span class="n">app_root_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prompter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_prompter</span><span class="p">(</span>
        <span class="n">is_visual</span><span class="p">,</span>
        <span class="n">main_prompt</span><span class="p">,</span>
        <span class="n">example_prompt</span><span class="p">,</span>
        <span class="n">api_prompt</span><span class="p">,</span>
        <span class="n">app_root_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="agents.agent.evaluation_agent.EvaluationAgent.status_manager" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">status_manager</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the status manager.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h2 id="agents.agent.evaluation_agent.EvaluationAgent.evaluate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">log_path</span><span class="p">,</span> <span class="n">eva_all_screenshots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Evaluate the task completion.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>log_path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The path to the log file.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>], <span title="float">float</span>]</code>
              –
              <div class="doc-md-description">
                <p>The evaluation result and the cost of LLM.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>agents/agent/evaluation_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">log_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">eva_all_screenshots</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the task completion.</span>
<span class="sd">    :param log_path: The path to the log file.</span>
<span class="sd">    :return: The evaluation result and the cost of LLM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_constructor</span><span class="p">(</span>
        <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="n">eva_all_screenshots</span><span class="o">=</span><span class="n">eva_all_screenshots</span>
    <span class="p">)</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span>
        <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">namescope</span><span class="o">=</span><span class="s2">&quot;eva&quot;</span><span class="p">,</span> <span class="n">use_backup_engine</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">json_parser</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">cost</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="agents.agent.evaluation_agent.EvaluationAgent.get_prompter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_prompter</span><span class="p">(</span><span class="n">is_visual</span><span class="p">,</span> <span class="n">prompt_template</span><span class="p">,</span> <span class="n">example_prompt_template</span><span class="p">,</span> <span class="n">api_prompt_template</span><span class="p">,</span> <span class="n">root_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get the prompter for the agent.</p>


            <details class="quote">
              <summary>Source code in <code>agents/agent/evaluation_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_prompter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_visual</span><span class="p">,</span>
    <span class="n">prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">example_prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">root_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationAgentPrompter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the prompter for the agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">EvaluationAgentPrompter</span><span class="p">(</span>
        <span class="n">is_visual</span><span class="o">=</span><span class="n">is_visual</span><span class="p">,</span>
        <span class="n">prompt_template</span><span class="o">=</span><span class="n">prompt_template</span><span class="p">,</span>
        <span class="n">example_prompt_template</span><span class="o">=</span><span class="n">example_prompt_template</span><span class="p">,</span>
        <span class="n">api_prompt_template</span><span class="o">=</span><span class="n">api_prompt_template</span><span class="p">,</span>
        <span class="n">root_name</span><span class="o">=</span><span class="n">root_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="agents.agent.evaluation_agent.EvaluationAgent.message_constructor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">message_constructor</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">eva_all_screenshots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Construct the message.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>log_path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The path to the log file.</p>
              </div>
            </li>
            <li>
              <b><code>request</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The request.</p>
              </div>
            </li>
            <li>
              <b><code>eva_all_screenshots</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>The flag indicating whether to evaluate all screenshots.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
              –
              <div class="doc-md-description">
                <p>The message.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>agents/agent/evaluation_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">message_constructor</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">log_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">eva_all_screenshots</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct the message.</span>
<span class="sd">    :param log_path: The path to the log file.</span>
<span class="sd">    :param request: The request.</span>
<span class="sd">    :param eva_all_screenshots: The flag indicating whether to evaluate all screenshots.</span>
<span class="sd">    :return: The message.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">evaagent_prompt_system_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompter</span><span class="o">.</span><span class="n">system_prompt_construction</span><span class="p">()</span>

    <span class="n">evaagent_prompt_user_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompter</span><span class="o">.</span><span class="n">user_content_construction</span><span class="p">(</span>
        <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="n">eva_all_screenshots</span><span class="o">=</span><span class="n">eva_all_screenshots</span>
    <span class="p">)</span>

    <span class="n">evaagent_prompt_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompter</span><span class="o">.</span><span class="n">prompt_construction</span><span class="p">(</span>
        <span class="n">evaagent_prompt_system_message</span><span class="p">,</span> <span class="n">evaagent_prompt_user_message</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">evaagent_prompt_message</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="agents.agent.evaluation_agent.EvaluationAgent.print_response" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_response</span><span class="p">(</span><span class="n">response_dict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Print the response of the evaluation.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>response_dict</code></b>
                  (<code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The response dictionary.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>agents/agent/evaluation_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print the response of the evaluation.</span>
<span class="sd">    :param response_dict: The response dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">emoji_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;yes&quot;</span><span class="p">:</span> <span class="s2">&quot;✅&quot;</span><span class="p">,</span>
        <span class="s2">&quot;no&quot;</span><span class="p">:</span> <span class="s2">&quot;❌&quot;</span><span class="p">,</span>
        <span class="s2">&quot;maybe&quot;</span><span class="p">:</span> <span class="s2">&quot;❓&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">complete</span> <span class="o">=</span> <span class="n">emoji_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">response_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">),</span> <span class="n">response_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;complete&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">sub_scores</span> <span class="o">=</span> <span class="n">response_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sub_scores&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">reason</span> <span class="o">=</span> <span class="n">response_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluation result🧐:&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
    <span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Sub-scores📊:]&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">evaluation</span> <span class="ow">in</span> <span class="n">sub_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">print_with_color</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">emoji_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span><span class="w"> </span><span class="n">evaluation</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span>
        <span class="p">)</span>

    <span class="n">print_with_color</span><span class="p">(</span>
        <span class="s2">&quot;[Task is complete💯:] </span><span class="si">{complete}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">complete</span><span class="o">=</span><span class="n">complete</span><span class="p">),</span> <span class="s2">&quot;cyan&quot;</span>
    <span class="p">)</span>

    <span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Reason🤔:] </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">),</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="agents.agent.evaluation_agent.EvaluationAgent.process_comfirmation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_comfirmation</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Comfirmation, currently do nothing.</p>


            <details class="quote">
              <summary>Source code in <code>agents/agent/evaluation_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_comfirmation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Comfirmation, currently do nothing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../follower_agent/" class="btn btn-neutral float-left" title="FollowerAgent"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../prompts/overview/" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../follower_agent/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../prompts/overview/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
