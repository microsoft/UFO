<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Overview - UFO³ Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Overview";
        var mkdocs_page_input_path = "ufo2/dataflow/overview.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> UFO³ Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../choose_path/">Choose Your Path</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../project_directory_structure/">Project Directory Structure</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_galaxy/">Quick Start (UFO³ Agent Galaxy)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_ufo2/">Quick Start (UFO²)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_linux/">Quick Start (Linux Agent)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/quick_start_mobile/">Quick Start (Mobile Agent)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/migration_ufo2_to_galaxy/">Migration UFO² → UFO³</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../getting_started/more_guidance/">More Guidance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration & Setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Configuration System</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/agents_config/">Agent Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/system_config/">System Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/rag_config/">RAG Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/prices_config/">Pricing Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/third_party_config/">Third-Party Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/mcp_reference/">MCP Reference</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/migration/">Migration Guide</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/system/extending/">Extending Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Galaxy Configuration</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_devices/">Devices</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_constellation/">Constellation</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../configuration/system/galaxy_agent/">Agent</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Model Setup</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/openai/">OpenAI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/azure_openai/">Azure OpenAI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/operator/">OpenAI CUA (Operator)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/gemini/">Gemini</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/claude/">Claude</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/qwen/">Qwen</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/deepseek/">DeepSeek</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/ollama/">Ollama</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../configuration/models/custom_model/">Custom Model</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UFO³ Agent Galaxy</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../galaxy/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../galaxy/webui/">WebUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Galaxy Client</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/constellation_client/">ConstellationClient</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/device_manager/">DeviceManager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/components/">Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/aip_integration/">AIP Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/client/galaxy_client/">GalaxyClient</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Agent Registration</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/agent_profile/">Agent Profile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/device_registry/">Device Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/agent_registration/registration_flow/">Registration Flow</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Task Constellation (DAG)</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_star/">TaskStar</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_star_line/">TaskStarLine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/task_constellation/">TaskConstellation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation/constellation_editor/">ConstellationEditor</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Constellation Agent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/strategy/">Strategy Pattern</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_agent/command/">MCP Commands</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Constellation Orchestrator</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/event_driven_coordination/">Event-Driven Coordination</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/asynchronous_scheduling/">Asynchronous Scheduling</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/safe_assignment_locking/">Safe Assignment Locking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/consistency_guarantees/">Consistency Guarantees</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/batched_editing/">Batched Editing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/constellation_manager/">Constellation Manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/constellation_orchestrator/api_reference/">API Reference</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Observer System</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/event_system/">Event System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/progress_observer/">Progress Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/agent_output_observer/">Agent Output Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/synchronizer/">Synchronizer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/metrics_observer/">Metrics Observer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/observer/visualization_observer/">Visualization Observer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation & Logging</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/trajectory_report/">Trajectory Report</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/performance_metrics/">Performance Metrics</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../galaxy/evaluation/result_json/">Result JSON Reference</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">UFO² Desktop AgentOS</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >HostAgent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../host_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../host_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../host_agent/strategy/">Processing Strategy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../host_agent/commands/">Command System</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >AppAgent</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../app_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../app_agent/state/">State Machine</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../app_agent/strategy/">Processing Strategy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../app_agent/commands/">Command System</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core Features</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../core_features/hybrid_actions/">Hybrid GUI–API Actions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Control Detection</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/control_detection/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/control_detection/uia_detection/">UIA Detection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/control_detection/visual_detection/">Visual Detection</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/control_detection/hybrid_detection/">Hybrid Detection</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Knowledge Substrate</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/knowledge_substrate/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/knowledge_substrate/learning_from_help_document/">Help Documents</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/knowledge_substrate/learning_from_bing_search/">Bing Search</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/knowledge_substrate/experience_learning/">Experience Learning</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../core_features/knowledge_substrate/learning_from_demonstration/">Demos</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../core_features/multi_action/">Speculative Multi-Action</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Advanced Usage</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/follower_mode/">Follower Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/batch_mode/">Batch Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/operator_as_app_agent/">Operator Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../advanced_usage/customization/">Customization</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Prompts</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../prompts/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../prompts/basic_template/">Basic Template</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../prompts/examples_prompts/">Examples</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../evaluation/evaluation_agent/">EvaluationAgent</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../evaluation/benchmark/overview/">Benchmark Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../evaluation/benchmark/windows_agent_arena/">Windows Agent Arena</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../evaluation/benchmark/osworld/">OSWorld (Windows)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Performance Logs</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/overview/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/evaluation_logs/">Evaluation Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/markdown_log_viewer/">Markdown Log Viewer</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/request_logs/">Request Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/screenshots_logs/">Screenshots Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/step_logs/">Step Logs</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../evaluation/logs/ui_tree_logs/">UI Tree Logs</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Dataflow</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Overview</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../instantiation/">Instantiation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../execution/">Execution</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../windows_app_env/">Windows App Environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../result/">Result</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Linux Agent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/state/">State Machine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/strategy/">Processing Strategy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../linux/commands/">MCP Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mobile Agent</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/as_galaxy_device/">Using as Galaxy Device</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/state/">State Machine</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/strategy/">Processing Strategy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mobile/commands/">MCP Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials & Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tutorials/creating_mcp_servers/">Creating Custom MCP Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tutorials/creating_third_party_agents/">Creating Custom Third-Party Agents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Creating Custom Device Agents</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/client_setup/">Client Setup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/core_components/">Core Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/mcp_server/">MCP Server</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/configuration/">Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/testing/">Testing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_device_agent/example_mobile_agent/">Example Mobile Agent</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Enhancing AppAgent Capabilities</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/help_document_provision/">Help Document Provision</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/demonstration_provision/">Demonstration Provision</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../tutorials/creating_app_agent/warpping_app_native_api/">Wrapping App-Native APIs</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Infrastructure</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Basic Modules</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/session/">Session</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/round/">Round</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/context/">Context</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/dispatcher/">Dispatcher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/session_pool/">Session Factory & Pool</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/modules/platform_sessions/">Platform Sessions</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Device Agent Architecture</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/agents/overview/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/agents/agent_types/">Agent Types & Implementation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../infrastructure/agents/server_client_architecture/">Server-Client Architecture</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Architecture Layers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/state/">State Layer (Level-1)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/processor/">Strategy Layer (Level-2)</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/strategy/">Strategy Components</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/command/">Command Layer (Level-3)</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Supporting Systems</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/memory/">Memory System</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/blackboard/">Blackboard</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../infrastructure/agents/design/prompter/">Prompter</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Interaction Protocol (AIP)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/messages/">Message Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/protocols/">Protocol Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/transport/">Transport Layer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/endpoints/">Endpoints</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../aip/resilience/">Resilience</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Server</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/session_manager/">Session Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/websocket_handler/">WebSocket Handler</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/client_connection_manager/">Client Connection Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/api/">HTTP API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../server/monitoring/">Monitoring</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Agent Client</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/quick_start/">Quick Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/websocket_client/">WebSocket Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/ufo_client/">UFO Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/computer_manager/">Computer Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/computer/">Computer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/device_info/">Device Info Provider</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../client/mcp_integration/">MCP Integration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MCP (Model Context Protocol)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/data_collection/">Data Collection Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/action/">Action Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/configuration/">Configuration Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/local_servers/">Local Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../mcp/remote_servers/">Remote Servers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Server Reference</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/ui_collector/">UICollector</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/host_ui_executor/">HostUIExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/app_ui_executor/">AppUIExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/command_line_executor/">CommandLineExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/word_com_executor/">WordCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/excel_com_executor/">ExcelCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/ppt_com_executor/">PowerPointCOMExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/pdf_reader_executor/">PDFReaderExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/constellation_editor/">ConstellationEditor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/hardware_executor/">HardwareExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/bash_executor/">BashExecutor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mcp/servers/mobile_executor/">MobileExecutor</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/LICENSE/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CODE_OF_CONDUCT/">Code of Conduct</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/DISCLAIMER/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/SUPPORT/">Support</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../faq/">FAQ</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">UFO³ Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">UFO² Desktop AgentOS</li>
          <li class="breadcrumb-item">Dataflow</li>
      <li class="breadcrumb-item active">Overview</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction">Introduction</h1>
<p>This repository contains the implementation of the <strong>Data Collection</strong> process for training the <strong>Large Action Models</strong> (LAMs) in the paper of <a href="https://arxiv.org/abs/2412.10047">Large Action Models: From Inception to Implementation</a>. The <strong>Data Collection</strong> process is designed to streamline task processing, ensuring that all necessary steps are seamlessly integrated from initialization to execution. This module is part of the <a href="https://arxiv.org/abs/2402.07939"><strong>UFO</strong></a> project.</p>
<h1 id="dataflow">Dataflow</h1>
<p>Dataflow uses UFO to implement <code>instantiation</code>, <code>execution</code>, and <code>dataflow</code> for a given task, with options for batch processing and single processing.</p>
<ol>
<li><strong><a href="../instantiation/">Instantiation</a></strong>:  Instantiation refers to the process of setting up and preparing a task for execution. This step typically involves <code>choosing template</code>, <code>prefill</code> and <code>filter</code>.</li>
<li><strong><a href="../execution/">Execution</a></strong>: Execution is the actual process of running the task. This step involves carrying out the actions or operations specified by the <code>Instantiation</code>. And after execution, an evaluate agent will evaluate the quality of the whole execution process.</li>
<li><strong>Dataflow</strong>: Dataflow is the overarching process that combines <strong>instantiation</strong> and <strong>execution</strong> into a single pipeline. It provides an end-to-end solution for processing tasks, ensuring that all necessary steps (from initialization to execution) are seamlessly integrated.</li>
</ol>
<p>You can use <code>instantiation</code> and <code>execution</code> independently if you only need to perform one specific part of the process. When both steps are required for a task, the <code>dataflow</code> process streamlines them, allowing you to execute tasks from start to finish in a single pipeline.</p>
<p>The overall processing of dataflow is as below. Given a task-plan data, the LLMwill instantiatie the task-action data, including choosing template, prefill, filter.</p>
<h1 align="center">
    <img src="../../img/overview.png">
</h1>

<h2 id="how-to-use">How To Use</h2>
<h3 id="1-install-packages">1. Install Packages</h3>
<p>You should install the necessary packages in the UFO root folder:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div>
<h3 id="2-configure-the-llms">2. Configure the LLMs</h3>
<p>Before running dataflow, you need to provide your LLM configurations <strong>individually for PrefillAgent and FilterAgent</strong>. You can create your own config file <code>dataflow/config/config.yaml</code>, by copying the <code>dataflow/config/config.yaml.template</code> and editing config for <strong>PREFILL_AGENT</strong> and <strong>FILTER_AGENT</strong> as follows:</p>
<h4 id="openai">OpenAI</h4>
<div class="highlight"><pre><span></span><code>VISUAL_MODE:<span class="w"> </span>True,<span class="w"> </span><span class="c1"># Whether to use the visual mode</span>
API_TYPE:<span class="w"> </span><span class="s2">&quot;openai&quot;</span><span class="w"> </span>,<span class="w"> </span><span class="c1"># The API type, &quot;openai&quot; for the OpenAI API.  </span>
API_BASE:<span class="w"> </span><span class="s2">&quot;https://api.openai.com/v1/chat/completions&quot;</span>,<span class="w"> </span><span class="c1"># The the OpenAI API endpoint.</span>
API_KEY:<span class="w"> </span><span class="s2">&quot;sk-&quot;</span>,<span class="w">  </span><span class="c1"># The OpenAI API key, begin with sk-</span>
API_VERSION:<span class="w"> </span><span class="s2">&quot;2024-02-15-preview&quot;</span>,<span class="w"> </span><span class="c1"># &quot;2024-02-15-preview&quot; by default</span>
API_MODEL:<span class="w"> </span><span class="s2">&quot;gpt-4-vision-preview&quot;</span>,<span class="w">  </span><span class="c1"># The only OpenAI model</span>
</code></pre></div>
<h4 id="azure-openai-aoai">Azure OpenAI (AOAI)</h4>
<div class="highlight"><pre><span></span><code>VISUAL_MODE:<span class="w"> </span>True,<span class="w"> </span><span class="c1"># Whether to use the visual mode</span>
API_TYPE:<span class="w"> </span><span class="s2">&quot;aoai&quot;</span><span class="w"> </span>,<span class="w"> </span><span class="c1"># The API type, &quot;aoai&quot; for the Azure OpenAI.  </span>
API_BASE:<span class="w"> </span><span class="s2">&quot;YOUR_ENDPOINT&quot;</span>,<span class="w"> </span><span class="c1">#  The AOAI API address. Format: https://{your-resource-name}.openai.azure.com</span>
API_KEY:<span class="w"> </span><span class="s2">&quot;YOUR_KEY&quot;</span>,<span class="w">  </span><span class="c1"># The aoai API key</span>
API_VERSION:<span class="w"> </span><span class="s2">&quot;2024-02-15-preview&quot;</span>,<span class="w"> </span><span class="c1"># &quot;2024-02-15-preview&quot; by default</span>
API_MODEL:<span class="w"> </span><span class="s2">&quot;gpt-4-vision-preview&quot;</span>,<span class="w">  </span><span class="c1"># The only OpenAI model</span>
API_DEPLOYMENT_ID:<span class="w"> </span><span class="s2">&quot;YOUR_AOAI_DEPLOYMENT&quot;</span>,<span class="w"> </span><span class="c1"># The deployment id for the AOAI API</span>
</code></pre></div>
<p>You can also non-visial model (e.g., GPT-4) for each agent, by setting <code>VISUAL_MODE: False</code> and proper <code>API_MODEL</code> (openai) and <code>API_DEPLOYMENT_ID</code> (aoai).</p>
<h4 id="non-visual-model-configuration">Non-Visual Model Configuration</h4>
<p>You can utilize non-visual models (e.g., GPT-4) for each agent by configuring the following settings in the <code>config.yaml</code> file:</p>
<ul>
<li><code>VISUAL_MODE: False # To enable non-visual mode.</code></li>
<li>Specify the appropriate <code>API_MODEL</code> (OpenAI) and <code>API_DEPLOYMENT_ID</code> (AOAI) for each agent.</li>
</ul>
<p>Ensure you configure these settings accurately to leverage non-visual models effectively.</p>
<h4 id="other-configurations">Other Configurations</h4>
<p><code>config_dev.yaml</code> specifies the paths of relevant files and contains default settings. The match strategy for the window match and control filter supports options:  <code>'contains'</code>, <code>'fuzzy'</code>, and <code>'regex'</code>, allowing flexible matching strategy for users. The <code>MAX_STEPS</code> is the max step for the execute_flow, which can be set by users.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The specific implementation and invocation method of the matching strategy can refer to <a href="../windows_app_env/">windows_app_env</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>BE CAREFUL!</strong> If you are using GitHub or other open-source tools, do not expose your <code>config.yaml</code> online, as it contains your private keys.</p>
</div>
<h3 id="3-prepare-files">3. Prepare Files</h3>
<p>Certain files need to be prepared before running the task.</p>
<h4 id="31-tasks-as-json">3.1. Tasks as JSON</h4>
<p>The tasks that need to be instantiated should be organized in a folder of JSON files, with the default folder path set to dataflow <code>/tasks</code>. This path can be changed in the <code>dataflow/config/config.yaml</code> file, or you can specify it in the terminal, as mentioned in <strong>4. Start Running</strong>. For example, a task stored in <code>dataflow/tasks/prefill/</code> may look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="c1">// The app you want to use</span>
<span class="w">    </span><span class="nt">&quot;app&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;word&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// A unique ID to distinguish different tasks </span>
<span class="w">    </span><span class="nt">&quot;unique_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// The task and steps to be instantiated</span>
<span class="w">    </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Type &#39;hello&#39; and set the font type to Arial&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;refined_steps&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;Type &#39;hello&#39;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;Set the font to Arial&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="32-templates-and-descriptions">3.2. Templates and Descriptions</h4>
<p>You should place an app file as a reference for instantiation in a folder named after the app.</p>
<p>For example, if you have <code>template1.docx</code> for Word, it should be located at <code>dataflow/templates/word/template1.docx</code>.</p>
<p>Additionally, for each app folder, there should be a <code>description.json</code> file located at <code>dataflow/templates/word/description.json</code>, which describes each template file in detail. It may look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;template1.docx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A document with a rectangle shape&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;template2.docx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A document with a line of text&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>If a <code>description.json</code> file is not present, one template file will be selected at random.</p>
<h4 id="33-final-structure">3.3. Final Structure</h4>
<p>Ensure the following files are in place:</p>
<ul>
<li>[X] JSON files to be instantiated</li>
<li>[X] Templates as references for instantiation</li>
<li>[X] Description file in JSON format</li>
</ul>
<p>The structure of the files can be:</p>
<div class="highlight"><pre><span></span><code>dataflow/
|
├── tasks
│   └── prefill
│       ├── bulleted.json
│       ├── delete.json
│       ├── draw.json
│       ├── macro.json
│       └── rotate.json
├── templates
│   └── word
│       ├── description.json
│       ├── template1.docx
│       ├── template2.docx
│       ├── template3.docx
│       ├── template4.docx
│       ├── template5.docx
│       ├── template6.docx
│       └── template7.docx
└── ...
</code></pre></div>
<h3 id="4-start-running">4. Start Running</h3>
<p>After finishing the previous steps, you can use the following commands in the command line. We provide single / batch process, for which you need to give the single file path / folder path. Determine the type of path provided by the user and automatically decide whether to process a single task or batch tasks.</p>
<p>Also, you can choose to use <code>instantiation</code> / <code>execution</code> sections individually, or use them as a whole section, which is named as <code>dataflow</code>.</p>
<p>The default task hub is set to be <code>"TASKS_HUB"</code> in <code>dataflow/config_dev.yaml</code>.</p>
<ul>
<li>Dataflow Task:</li>
</ul>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>dataflow<span class="w"> </span>-dataflow<span class="w"> </span>--task_path<span class="w"> </span>path_to_task_file
</code></pre></div>
<ul>
<li>Instantiation Task:</li>
</ul>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>dataflow<span class="w"> </span>-instantiation<span class="w"> </span>--task_path<span class="w"> </span>path_to_task_file
</code></pre></div>
<ul>
<li>Execution Task:</li>
</ul>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>dataflow<span class="w"> </span>-execution<span class="w"> </span>--task_path<span class="w"> </span>path_to_task_file
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol>
<li>Users should be careful to save the original files while using this project; otherwise, the files will be closed when the app is shut down.</li>
<li>After starting the project, users should not close the app window while the program is taking screenshots.</li>
</ol>
</div>
<h2 id="workflow">Workflow</h2>
<h3 id="instantiation">Instantiation</h3>
<p>There are three key steps in the instantiation process:</p>
<ol>
<li><code>Choose a template</code> file according to the specified app and instruction.</li>
<li><code>Prefill</code> the task using the current screenshot.</li>
<li><code>Filter</code> the established task.</li>
</ol>
<p>Given the initial task, the dataflow first choose a template (<code>Phase 1</code>), the prefill the initial task based on word envrionment to obtain task-action data (<code>Phase 2</code>). Finnally, it will filter the established task to evaluate the quality of task-action data. (<code>Phase 3</code>)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The more detailed code design documentation for instantiation can be found in <a href="../instantiation/">instantiation</a>.</p>
</div>
<h3 id="execution">Execution</h3>
<p>The instantiated plans will be executed by a execute task. After execution, evalution agent will evaluation the quality of the entire execution process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The more detailed code design documentation for execution can be found in <a href="../execution/">execution</a>.</p>
</div>
<h2 id="result">Result</h2>
<p>The results will be saved in the <code>results\</code> directory under <code>instantiation</code>, <code>execution</code>, and <code>dataflow</code>, and will be further stored in subdirectories based on the execution outcomes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The more detailed information of result can be found in <a href="../result/">result</a>.</p>
</div>
<h2 id="quick-start">Quick Start</h2>
<p>We prepare two cases to show the dataflow, which can be found in <code>dataflow\tasks\prefill</code>. So after installing required packages, you can type the following command in the command line:</p>
<div class="highlight"><pre><span></span><code>python -m dataflow -dataflow
</code></pre></div>
<p>And you can see the hints showing in the terminal, which means the dataflow is working.</p>
<h3 id="structure-of-related-files">Structure of related files</h3>
<p>After the two tasks are finished, the task and output files would appear as follows:</p>
<div class="highlight"><pre><span></span><code>UFO/
├──<span class="w"> </span>dataflow/
│<span class="w">   </span>└──<span class="w"> </span>results/
│<span class="w">       </span>├──<span class="w"> </span>saved_document/<span class="w">         </span><span class="c1"># Directory for saved documents</span>
│<span class="w">       </span>│<span class="w">   </span>├──<span class="w"> </span>bulleted.docx<span class="w">       </span><span class="c1"># Result of the &quot;bulleted&quot; task</span>
│<span class="w">       </span>│<span class="w">   </span>└──<span class="w"> </span>rotate.docx<span class="w">         </span><span class="c1"># Result of the &quot;rotate&quot; task</span>
│<span class="w">       </span>├──<span class="w"> </span>dataflow/<span class="w">                    </span><span class="c1"># Dataflow results directory</span>
│<span class="w">       </span>│<span class="w">   </span>├──<span class="w"> </span>execution_pass/<span class="w">     </span><span class="c1"># Successfully executed tasks</span>
│<span class="w">       </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>bulleted.json<span class="w">   </span><span class="c1"># Execution result for the &quot;bulleted&quot; task</span>
│<span class="w">       </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>rotate.json<span class="w">      </span><span class="c1"># Execution result for the &quot;rotate&quot; task</span>
│<span class="w">       </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
└──<span class="w"> </span>...
</code></pre></div>
<p>The specific results can be referenced in the <a href="../result/">result</a> in JSON format along with example data.</p>
<h3 id="log-files">Log files</h3>
<p>The corresponding logs can be found in the directories <code>logs/bulleted</code> and <code>logs/rotate</code>, as shown below. Detailed logs for each workflow are recorded, capturing every step of the execution process.</p>
<h1 align="center">
    <img src="../../img/result_example.png"/> 
</h1>

<h1 id="reference">Reference</h1>
<h3 id="appenum">AppEnum</h3>


<div class="doc doc-object doc-class">



<a id="data_flow_controller.AppEnum"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enum class for applications.</p>

        <p>Initialize the application enum.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>id</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The ID of the application.</p>
              </div>
            </li>
            <li>
              <b><code>description</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The description of the application.</p>
              </div>
            </li>
            <li>
              <b><code>file_extension</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The file extension of the application.</p>
              </div>
            </li>
            <li>
              <b><code>win_app</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The Windows application name.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">win_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the application enum.</span>
<span class="sd">    :param id: The ID of the application.</span>
<span class="sd">    :param description: The description of the application.</span>
<span class="sd">    :param file_extension: The file extension of the application.</span>
<span class="sd">    :param win_app: The Windows application name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_extension</span> <span class="o">=</span> <span class="n">file_extension</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">win_app</span> <span class="o">=</span> <span class="n">win_app</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_root_name</span> <span class="o">=</span> <span class="n">win_app</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.EXE&quot;</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div><h3 id="taskobject">TaskObject</h3>


<div class="doc doc-object doc-class">



<a id="data_flow_controller.TaskObject"></a>
    <div class="doc doc-contents first">


        <p>Initialize the task object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>task_file_path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The path to the task file.</p>
              </div>
            </li>
            <li>
              <b><code>task_type</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The task_type of the task object (dataflow, instantiation, or execution).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the task object.</span>
<span class="sd">    :param task_file_path: The path to the task file.</span>
<span class="sd">    :param task_type: The task_type of the task object (dataflow, instantiation, or execution).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">task_file_path</span> <span class="o">=</span> <span class="n">task_file_path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_file_base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">task_file_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_file_base_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">task_json_file</span> <span class="o">=</span> <span class="n">load_json_file</span><span class="p">(</span><span class="n">task_file_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_app_from_json</span><span class="p">(</span><span class="n">task_json_file</span><span class="p">[</span><span class="s2">&quot;app&quot;</span><span class="p">])</span>
    <span class="c1"># Initialize the task attributes based on the task_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_attr</span><span class="p">(</span><span class="n">task_type</span><span class="p">,</span> <span class="n">task_json_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div><h3 id="dataflowcontroller">DataFlowController</h3>


<div class="doc doc-object doc-class">



<a id="data_flow_controller.DataFlowController"></a>
    <div class="doc doc-contents first">


        <p>Flow controller class to manage the instantiation and execution process.</p>

        <p>Initialize the flow controller.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>task_path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The path to the task file.</p>
              </div>
            </li>
            <li>
              <b><code>task_type</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The task_type of the flow controller (instantiation, execution, or dataflow).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the flow controller.</span>
<span class="sd">    :param task_path: The path to the task file.</span>
<span class="sd">    :param task_type: The task_type of the flow controller (instantiation, execution, or dataflow).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span> <span class="o">=</span> <span class="n">TaskObject</span><span class="p">(</span><span class="n">task_path</span><span class="p">,</span> <span class="n">task_type</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_env</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">app_object</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task_file_name</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_schema</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">=</span> <span class="n">task_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_task_info</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">result_hub</span> <span class="o">=</span> <span class="n">_configs</span><span class="p">[</span><span class="s2">&quot;RESULT_HUB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_type</span><span class="o">=</span><span class="n">task_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="data_flow_controller.DataFlowController.instantiated_plan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">instantiated_plan</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the instantiated plan from the task information.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
              –
              <div class="doc-md-description">
                <p>The instantiated plan.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="data_flow_controller.DataFlowController.template_copied_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">template_copied_path</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get the copied template path from the task information.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="str">str</span></code>
              –
              <div class="doc-md-description">
                <p>The copied template path.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.execute_execution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_execution</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Execute the execution process.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>request</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The task request to be executed.</p>
              </div>
            </li>
            <li>
              <b><code>plan</code></b>
                  (<code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="any">any</span>]</code>)
              –
              <div class="doc-md-description">
                <p>The execution plan containing detailed steps.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">plan</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the execution process.</span>
<span class="sd">    :param request: The task request to be executed.</span>
<span class="sd">    :param plan: The execution plan containing detailed steps.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">print_with_color</span><span class="p">(</span><span class="s2">&quot;Executing the execution process...&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">execute_flow</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_env</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template_copied_path</span><span class="p">)</span>
        <span class="c1"># Initialize the execution context and flow</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
        <span class="n">execute_flow</span> <span class="o">=</span> <span class="n">ExecuteFlow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_file_name</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_env</span><span class="p">)</span>

        <span class="c1"># Execute the plan</span>
        <span class="n">executed_plan</span><span class="p">,</span> <span class="n">execute_result</span> <span class="o">=</span> <span class="n">execute_flow</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>

        <span class="c1"># Update the instantiated plan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_plan</span> <span class="o">=</span> <span class="n">executed_plan</span>
        <span class="c1"># Record execution results and time metrics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;execution_result&quot;</span><span class="p">][</span><span class="s2">&quot;result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">execute_result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">execute_flow</span><span class="o">.</span><span class="n">execution_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;execute_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">execute_flow</span><span class="o">.</span><span class="n">eval_time</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle and log any exceptions that occur during execution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;execution_result&quot;</span><span class="p">][</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span>
            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="s2">&quot;traceback&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in Execution: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">e</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Record the total time cost of the execution process</span>
        <span class="k">if</span> <span class="n">execute_flow</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">execute_flow</span><span class="p">,</span> <span class="s2">&quot;execution_time&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">execute_flow</span><span class="o">.</span><span class="n">execution_time</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">execute_flow</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">execute_flow</span><span class="p">,</span> <span class="s2">&quot;eval_time&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;execute_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">execute_flow</span><span class="o">.</span><span class="n">eval_time</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;execute_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.execute_instantiation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_instantiation</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Execute the instantiation process.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
              –
              <div class="doc-md-description">
                <p>The instantiation plan if successful.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute_instantiation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the instantiation process.</span>
<span class="sd">    :return: The instantiation plan if successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">print_with_color</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Instantiating task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task_file_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span>
    <span class="p">)</span>

    <span class="n">template_copied_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiation_single_flow</span><span class="p">(</span>
        <span class="n">ChooseTemplateFlow</span><span class="p">,</span>
        <span class="s2">&quot;choose_template&quot;</span><span class="p">,</span>
        <span class="n">init_params</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">app_object</span><span class="o">.</span><span class="n">file_extension</span><span class="p">],</span>
        <span class="n">execute_params</span><span class="o">=</span><span class="p">[],</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">template_copied_path</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_env</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">template_copied_path</span><span class="p">)</span>

        <span class="n">prefill_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiation_single_flow</span><span class="p">(</span>
            <span class="n">PrefillFlow</span><span class="p">,</span>
            <span class="s2">&quot;prefill&quot;</span><span class="p">,</span>
            <span class="n">init_params</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">app_env</span><span class="p">],</span>
            <span class="n">execute_params</span><span class="o">=</span><span class="p">[</span>
                <span class="n">template_copied_path</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">refined_steps</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">prefill_result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instantiation_single_flow</span><span class="p">(</span>
                <span class="n">FilterFlow</span><span class="p">,</span>
                <span class="s2">&quot;instantiation_evaluation&quot;</span><span class="p">,</span>
                <span class="n">init_params</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">execute_params</span><span class="o">=</span><span class="p">[</span><span class="n">prefill_result</span><span class="p">[</span><span class="s2">&quot;instantiated_request&quot;</span><span class="p">]],</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">prefill_result</span><span class="p">[</span><span class="s2">&quot;instantiated_plan&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.init_task_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init_task_info</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initialize the task information.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
              –
              <div class="doc-md-description">
                <p>The initialized task information.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_task_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the task information.</span>
<span class="sd">    :return: The initialized task information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">init_task_info</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">==</span> <span class="s2">&quot;execution&quot;</span><span class="p">:</span>
        <span class="c1"># read from the instantiated task file</span>
        <span class="n">init_task_info</span> <span class="o">=</span> <span class="n">load_json_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task_file_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">init_task_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;unique_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">unique_id</span><span class="p">,</span>
            <span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">,</span>
            <span class="s2">&quot;original&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;original_task&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task</span><span class="p">,</span>
                <span class="s2">&quot;original_steps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">refined_steps</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;execution_result&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
            <span class="s2">&quot;instantiation_result&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;choose_template&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                <span class="s2">&quot;prefill&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                <span class="s2">&quot;instantiation_evaluation&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;time_cost&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="p">}</span>
    <span class="k">return</span> <span class="n">init_task_info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.instantiation_single_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">instantiation_single_flow</span><span class="p">(</span><span class="n">flow_class</span><span class="p">,</span> <span class="n">flow_type</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">execute_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Execute a single flow process in the instantiation phase.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>flow_class</code></b>
                  (<code><span title="ufo.agents.processors.app_agent_processor.AppAgentProcessor">AppAgentProcessor</span></code>)
              –
              <div class="doc-md-description">
                <p>The flow class to instantiate.</p>
              </div>
            </li>
            <li>
              <b><code>flow_type</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The type of the flow.</p>
              </div>
            </li>
            <li>
              <b><code>init_params</code></b>
              –
              <div class="doc-md-description">
                <p>The initialization parameters for the flow.</p>
              </div>
            </li>
            <li>
              <b><code>execute_params</code></b>
              –
              <div class="doc-md-description">
                <p>The execution parameters for the flow.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
              –
              <div class="doc-md-description">
                <p>The result of the flow process.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">instantiation_single_flow</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">flow_class</span><span class="p">:</span> <span class="n">AppAgentProcessor</span><span class="p">,</span>
    <span class="n">flow_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">execute_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a single flow process in the instantiation phase.</span>
<span class="sd">    :param flow_class: The flow class to instantiate.</span>
<span class="sd">    :param flow_type: The type of the flow.</span>
<span class="sd">    :param init_params: The initialization parameters for the flow.</span>
<span class="sd">    :param execute_params: The execution parameters for the flow.</span>
<span class="sd">    :return: The result of the flow process.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flow_instance</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">flow_instance</span> <span class="o">=</span> <span class="n">flow_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_file_name</span><span class="p">,</span> <span class="o">*</span><span class="n">init_params</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">flow_instance</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">execute_params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;instantiation_result&quot;</span><span class="p">][</span><span class="n">flow_type</span><span class="p">][</span><span class="s2">&quot;result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;instantiation_result&quot;</span><span class="p">][</span><span class="n">flow_type</span><span class="p">][</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="vm">__class__</span><span class="p">),</span>
            <span class="s2">&quot;error_message&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="s2">&quot;traceback&quot;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in </span><span class="si">{</span><span class="n">flow_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flow_instance</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">flow_instance</span><span class="p">,</span> <span class="s2">&quot;execution_time&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="n">flow_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_instance</span><span class="o">.</span><span class="n">execution_time</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="n">flow_type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.reformat_to_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reformat_to_batch</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Transfer the result to the result hub.</p>


            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reformat_to_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transfer the result to the result hub.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">source_files_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_hub</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">+</span> <span class="s2">&quot;_pass&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">source_template_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_hub</span><span class="p">),</span>
        <span class="s2">&quot;saved_document&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">target_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="s2">&quot;tasks&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">target_template_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="s2">&quot;files&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">((</span><span class="n">target_file_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">((</span><span class="n">target_template_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">source_files_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="n">source_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_files_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">target_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_file_path</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
            <span class="n">target_object</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">target_template_path</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.docx&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">is_successed</span> <span class="o">=</span> <span class="n">reformat_json_file</span><span class="p">(</span>
                <span class="n">target_file</span><span class="p">,</span>
                <span class="n">target_object</span><span class="p">,</span>
                <span class="n">load_json_file</span><span class="p">(</span><span class="n">source_file</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">is_successed</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">source_template_path</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.docx&quot;</span><span class="p">)</span>
                    <span class="p">),</span>
                    <span class="n">target_template_path</span><span class="p">,</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Run the instantiation and execution process.</p>


            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the instantiation and execution process.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_env</span> <span class="o">=</span> <span class="n">WindowsAppEnv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">app_object</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">==</span> <span class="s2">&quot;dataflow&quot;</span><span class="p">:</span>
            <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_instantiation</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute_execution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">==</span> <span class="s2">&quot;instantiation&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute_instantiation</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">==</span> <span class="s2">&quot;execution&quot;</span><span class="p">:</span>
            <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_plan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute_execution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported task_type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">task_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Update or record the total time cost of the process</span>
        <span class="n">total_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">new_total_time</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;time_cost&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">total_time</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;time_cost&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_total_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">_configs</span><span class="p">[</span><span class="s2">&quot;REFORMAT_TO_BATCH&quot;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reformat_to_batch</span><span class="p">(</span><span class="n">_configs</span><span class="p">[</span><span class="s2">&quot;REFORMAT_TO_BATCH_HUB&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="data_flow_controller.DataFlowController.save_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_result</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Validate and save the instantiated task result.</p>


            <details class="quote">
              <summary>Source code in <code>dataflow/data_flow_controller.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_result</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate and save the instantiated task result.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">validation_error</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Validate the result against the schema</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">validate</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Record the validation error but allow the process to continue</span>
        <span class="n">validation_error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
        <span class="n">print_with_color</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation Error: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

    <span class="c1"># Determine the target directory based on task_type and quality/completeness</span>
    <span class="n">target_file</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_type</span> <span class="o">==</span> <span class="s2">&quot;instantiation&quot;</span><span class="p">:</span>
        <span class="c1"># Determine the quality of the instantiation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;instantiation_result&quot;</span><span class="p">][</span><span class="s2">&quot;instantiation_evaluation&quot;</span><span class="p">][</span>
            <span class="s2">&quot;result&quot;</span>
        <span class="p">]:</span>
            <span class="n">target_file</span> <span class="o">=</span> <span class="n">INSTANTIATION_RESULT_MAP</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_quality_good</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;instantiation_result&quot;</span><span class="p">][</span>
                <span class="s2">&quot;instantiation_evaluation&quot;</span>
            <span class="p">][</span><span class="s2">&quot;result&quot;</span><span class="p">][</span><span class="s2">&quot;judge&quot;</span><span class="p">]</span>
            <span class="n">target_file</span> <span class="o">=</span> <span class="n">INSTANTIATION_RESULT_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">is_quality_good</span><span class="p">,</span> <span class="n">INSTANTIATION_RESULT_MAP</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Determine the completion status of the execution</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;execution_result&quot;</span><span class="p">][</span><span class="s2">&quot;result&quot;</span><span class="p">]:</span>
            <span class="n">target_file</span> <span class="o">=</span> <span class="n">EXECUTION_RESULT_MAP</span><span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_completed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">[</span><span class="s2">&quot;execution_result&quot;</span><span class="p">][</span><span class="s2">&quot;result&quot;</span><span class="p">][</span><span class="s2">&quot;complete&quot;</span><span class="p">]</span>
            <span class="n">target_file</span> <span class="o">=</span> <span class="n">EXECUTION_RESULT_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">is_completed</span><span class="p">,</span> <span class="n">EXECUTION_RESULT_MAP</span><span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="c1"># Construct the full path to save the result</span>
    <span class="n">new_task_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_hub</span><span class="p">,</span> <span class="n">target_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_object</span><span class="o">.</span><span class="n">task_file_base_name</span>
    <span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">new_task_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">save_json_file</span><span class="p">(</span><span class="n">new_task_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_info</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task saved to </span><span class="si">{</span><span class="n">new_task_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># If validation failed, indicate that the saved result may need further inspection</span>
    <span class="k">if</span> <span class="n">validation_error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;The saved task result does not conform to the expected schema and may require review.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../evaluation/logs/ui_tree_logs/" class="btn btn-neutral float-left" title="UI Tree Logs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../instantiation/" class="btn btn-neutral float-right" title="Instantiation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../evaluation/logs/ui_tree_logs/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../instantiation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      <script src="../../../javascripts/mermaid-init.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
